(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-19447745","chunk-2d0abad8","chunk-2d21406a"],{"15fd":function(t,e,a){"use strict";function n(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;a[n]=t[n]}return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)a=o[n],e.includes(a)||{}.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}a.d(e,"a",(function(){return n})),a("a4d3"),a("caad"),a("2532")},2545:function(t,e,a){},"4e9f":function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"i",(function(){return i})),a.d(e,"g",(function(){return c})),a.d(e,"d",(function(){return s})),a.d(e,"c",(function(){return u})),a.d(e,"f",(function(){return l})),a.d(e,"e",(function(){return d})),a.d(e,"h",(function(){return g}));var n=a("b775");function r(t){return Object(n.a)({url:"/carbon/airport/getAirportByCityName/"+t,method:"get"})}function o(t){return Object(n.a)({url:"/carbon/airport/getAirportPageByNameLike",method:"post",data:t})}function i(){return Object(n.a)({url:"/carbon/calc/getVehicleTypeList",method:"get"})}function c(){return Object(n.a)({url:"/carbon/power/fuel/getPowerAndFuelList",method:"get"})}function s(){return Object(n.a)({url:"/carbon/calc/getFactorProjectList",method:"get"})}function u(t){return Object(n.a)({url:"/dict/data/type/"+t,method:"get"})}function l(t){return Object(n.a)({url:"/carbon/port/getPortPageByPortName",method:"post",data:t})}function d(t){return Object(n.a)({url:"/carbon/port/getPortPageByCityName",method:"post",data:t})}function g(t){return Object(n.a)({url:"/carbon/railwayStation/getRailwayStationPageByName",method:"post",data:t})}},"9d44":function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"j",(function(){return i})),a.d(e,"h",(function(){return c})),a.d(e,"i",(function(){return s})),a.d(e,"f",(function(){return u})),a.d(e,"e",(function(){return l})),a.d(e,"c",(function(){return d})),a.d(e,"d",(function(){return g})),a.d(e,"g",(function(){return m}));var n=a("b775");function r(t){return Object(n.a)({url:"/carbon/calc/airTransportCEmission",method:"post",data:t})}function o(t){return Object(n.a)({url:"/carbon/calc/automobileTransportCEmission",method:"post",data:t})}function i(t){return Object(n.a)({url:"/carbon/calc/transportCEmissionSeaCalc",method:"post",data:t})}function c(t){return Object(n.a)({url:"/carbon/calc/transportCEmissionFastCalc",method:"post",data:t})}function s(t){return Object(n.a)({url:"/carbon/calc/transportCEmissionRailwayCalc",method:"post",data:t})}function u(t){return Object(n.a)({url:"/carbon/calc/logisticsStationCEmissionCalc",method:"post",data:t})}function l(){return Object(n.a)({url:"/carbon/province/city/getProvinceListByLike/",method:"get"})}function d(t){return Object(n.a)({url:"/carbon/province/city/getCityListByLikeAndPCode",method:"post",data:t})}function g(t){return Object(n.a)({url:"/carbon/addressLocate/getLocationMessageByAddress",method:"post",data:t})}function m(t){return Object(n.a)({url:"/carbon/calcOrg/organizationalCarbonCalculate",method:"post",data:t})}},aed4:function(t,e,a){"use strict";a.r(e),a.d(e,"cateNoList",(function(){return o})),a.d(e,"getTransportIcon",(function(){return i})),a.d(e,"initPoints",(function(){return c})),a.d(e,"formatNumberDeci",(function(){return s})),a.d(e,"getPreTransportItem",(function(){return u})),a("c740"),a("14d9"),a("a9e3"),a("d3b7"),a("159b");var n=a("2ef0"),r=a.n(n),o=[{icon:"goodsTrain",name:"道路运输",cateNo:"glys"},{icon:"railway",name:"铁路运输",cateNo:"tlys"},{icon:"ship",name:"水路运输",cateNo:"syys"},{icon:"airplane",name:"航空运输",cateNo:"kyys"},{icon:"shopStore",name:"仓库",cateNo:"cksy"},{icon:"site",name:"集装箱场站",cateNo:"czsy"},{icon:"wharf",name:"码头",cateNo:"mtsy"},{icon:"help",name:"配送",cateNo:"ps",open:!1},{icon:"port",name:"港口",cateNo:"gk",open:!1},{icon:"inlandPort",name:"内陆港",cateNo:"nlg",open:!1},{icon:"airPort",name:"航空港",cateNo:"hkg",open:!1},{icon:"package",name:"包装",cateNo:"bz",open:!1}];function i(t){var e="";switch(t){case"syys":e="boat";break;case"kyys":e="plant";break;case"tlys":e="train";break;case"glys":e="car";break;case"mtsy":e="wharf";break;case"czsy":e="site";break;case"cksy":e="shop"}return e}var c=function(t){var e=[];return(t||[]).forEach((function(t){var a={};"glys"===t.cateNo?(a.originLocation=t.oriProvinceName+t.oriCityName,a.destLocation=t.destProvinceName+t.destCityName):t.oriLatAndLng&&t.destLatAndLng&&(a.originLng=t.oriLatAndLng.lng,a.originLat=t.oriLatAndLng.lat,a.destLng=t.destLatAndLng.lng,a.destLat=t.destLatAndLng.lat),a.transportType=i(t.cateNo),e.push(a)})),e},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return r.a.round(Number(t),e)},u=function(t,e,a){var n=null;if("edit"===a&&e){var r=t.findIndex((function(t){return t.id===e}));r>0&&(n=t[r-1])}else n=t[t.length-1];return n}},cac8:function(t,e,a){"use strict";a.r(e);var n=a("c7eb"),r=a("1da1"),o=a("15fd"),i=a("5530"),c=(a("7db0"),a("d81d"),a("a9e3"),a("d3b7"),a("ac1f"),a("5319"),a("9d44")),s=a("4e9f"),u=a("2ef0"),l=a.n(u),d=a("aed4"),g=["oriLatAndLng","destLatAndLng"],m={props:{cateNo:{type:String},id:{type:[String,Number]},type:{type:String,default:"add"}},data:function(){return{loading:!1,tForm:{storageName:null,cargoWeight:null,logisticsStage:null,containerCount:null,transportationDistance:null,logisticsStationType:2},logisticsStageList:[],rules:{storageName:[{required:!0,message:"请输入码头名称",trigger:["blur","change"]}],cargoWeight:[{required:!0,message:"请输入货物重量",trigger:["blur","change"]}],logisticsStage:[{required:!0,message:"请选择所属环节",trigger:["blur","change"]}],containerCount:[{required:!0,message:"请输入集装箱数量",trigger:["blur","change"]}],transportationDistance:[{required:!0,message:"请输入场内运输距离",trigger:["blur","change"]}]},oriLatAndLng:{},destLatAndLng:{}}},watch:{"tForm.storageName":{handler:function(t,e){var a=this;if(t){var n={address:t};Object(c.d)(n).then((function(t){200===t.code&&(a.oriLatAndLng={lng:t.data.lng,lat:t.data.lat},a.destLatAndLng={lng:t.data.lng,lat:t.data.lat},a.tForm.oriProvinceName=t.data.province||t.data.country,a.tForm.oriCityName=t.data.city,a.tForm.destProvinceName=t.data.province||t.data.country,a.tForm.destCityName=t.data.city,a.$store.commit("SET_SINGLE_LOCATION",[Object(i.a)(Object(i.a)({},a.oriLatAndLng),{},{transportType:"site"})]))}))}else this.$store.commit("SET_SINGLE_LOCATION",[])}}},mounted:function(){var t=this;if(this.id){this.$store.commit("SET_RESULT_INFO",this.id);var e=this.$store.getters.getResultItem,a=e.oriLatAndLng,n=e.destLatAndLng,r=Object(o.a)(e,g);this.$set(this,"tForm",r),this.oriLatAndLng=a||{},this.destLatAndLng=n||{};var i={lng:this.oriLatAndLng.lng,lat:this.oriLatAndLng.lat,transportType:"site"};this.$store.commit("SET_SINGLE_LOCATION",[i])}else{var c=this.$store.getters.getGoodsInfo||{};this.tForm.cargoWeight=l.a.round(Number(c.weight)/1e3,3)}Object(s.c)("tjsq_logistics_stage_type").then((function(e){t.logisticsStageList=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))}))},methods:{formatNumberDeci:d.formatNumberDeci,submit:function(){var t=this;return Object(r.a)(Object(n.a)().mark((function e(){var a,r,o,s;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$refs.tForm.validate();case 4:return a={storageName:t.tForm.storageName,cargoWeight:t.tForm.cargoWeight,logisticsStage:t.tForm.logisticsStage,containerCount:t.tForm.containerCount,transportationDistance:t.tForm.transportationDistance,logisticsStationType:t.tForm.logisticsStationType},e.next=8,Object(c.f)(a);case 8:if(200!==(r=e.sent).code){e.next=18;break}return o=Object(i.a)(Object(i.a)({},t.tForm),{},{id:r.data.id,distance:r.data.distance||t.tForm.transportationDistance||0,carbonEmissionQty:r.data.emission,cateNo:t.cateNo,oriLatAndLng:t.oriLatAndLng,destLatAndLng:t.destLatAndLng}),e.next=13,new Promise((function(e,a){t.$emit("saveMap2Image",e,a)}));case 13:(s=e.sent)&&(o.imgSrc=s),"add"===t.type?t.$store.commit("SET_RESULT_LIST",o):"edit"===t.type&&t.$store.commit("EDIT_RESULT_LIST",{data:o,originId:t.id}),t.$router.replace({name:"carbonResult"});case 18:t.loading=!1,e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),t.loading=!1;case 25:case"end":return e.stop()}}),e,null,[[0,21]])})))()},reset:function(){this.resetForm("tForm")},changeLogisticsStage:function(t){this.tForm.containerCount=null,this.tForm.transportationDistance=null;var e=this.logisticsStageList.find((function(e){return e.value===t}));e&&(this.tForm.logisticsStageLabel=e.label)}}},p=m,f=(a("f9da"),a("2877")),b=Object(f.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"station-transport"},[a("el-form",{ref:"tForm",attrs:{model:t.tForm,rules:t.rules,inline:!0}},["read"===t.type?a("div",{staticClass:"carbon-info"},[a("div",{staticClass:"carbon-title-box"},[a("div",{staticClass:"left"},[a("p",[t._v(" 里程："),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.distance,3)))]),a("span",{staticClass:"unit"},[t._v("km")])])]),a("div",{staticClass:"right"},[a("p",[t._v(" 温室气体排放:"),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.carbonEmissionQty,3)))]),a("span",{staticClass:"unit"},[t._v("kg")])])])]),a("el-divider")],1):t._e(),a("el-form-item",{attrs:{label:"场站名称",prop:"storageName"}},[a("el-input",{attrs:{placeholder:"请输入场站名称",disabled:"read"===t.type},model:{value:t.tForm.storageName,callback:function(e){t.$set(t.tForm,"storageName",e)},expression:"tForm.storageName"}})],1),a("el-form-item",{attrs:{label:"货物重量",prop:"cargoWeight"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入货物重量",disabled:""},model:{value:t.tForm.cargoWeight,callback:function(e){t.$set(t.tForm,"cargoWeight",e)},expression:"tForm.cargoWeight"}},[a("template",{slot:"append"},[t._v("t")])],2)],1),a("el-form-item",{attrs:{label:"所属环节",prop:"logisticsStage"}},[a("el-select",{attrs:{placeholder:"请选择所属环节",disabled:"read"===t.type},on:{change:t.changeLogisticsStage},model:{value:t.tForm.logisticsStage,callback:function(e){t.$set(t.tForm,"logisticsStage",e)},expression:"tForm.logisticsStage"}},t._l(t.logisticsStageList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),1==t.tForm.logisticsStage?a("el-form-item",{attrs:{label:"集装箱数量",prop:"containerCount"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入集装箱数量",disabled:"read"===t.type},model:{value:t.tForm.containerCount,callback:function(e){t.$set(t.tForm,"containerCount",e)},expression:"tForm.containerCount"}},[a("template",{slot:"append"},[t._v("TEU")])],2)],1):a("el-form-item",{attrs:{label:"场内运输距离",prop:"transportationDistance"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入场内运输距离",disabled:"read"===t.type},model:{value:t.tForm.transportationDistance,callback:function(e){t.$set(t.tForm,"transportationDistance",e)},expression:"tForm.transportationDistance"}},[a("template",{slot:"append"},[t._v("km")])],2)],1)],1),"read"!==t.type?a("div",{staticClass:"footer-btns"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交并测算")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"pain"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1):t._e()],1)}),[],!1,null,"51773698",null);e.default=b.exports},f9da:function(t,e,a){"use strict";a("2545")}}]);