(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0ca574d2"],{"06f8":function(t,e,a){},"07ac":function(t,e,a){var r=a("23e7"),n=a("6f53").values;r({target:"Object",stat:!0},{values:function(t){return n(t)}})},"08a5":function(t,e,a){"use strict";a("2ace")},"0f79":function(t,e,a){"use strict";a.r(e);var r=a("c7eb"),n=a("1da1"),i=a("5530"),o=(a("7db0"),a("d81d"),a("a9e3"),a("d3b7"),a("ac1f"),a("5319"),a("9d44")),s=a("4e9f"),l=a("aed4"),c={props:{cateNo:{type:String},id:{type:[String,Number]},type:{type:String,default:"add"}},data:function(){return{loading:!1,tForm:{storageName:null,storageType:null,cargoVolume:null,logisticsStage:null,logisticsStationType:1},storageTypeList:[{value:"1",label:"常温库"},{value:"2",label:"冷库"}],rules:{storageName:[{required:!0,message:"请输入仓库详细地址",trigger:["change","blur"]}],storageType:[{required:!0,message:"请选择仓库类型",trigger:"change"}],cargoVolume:[{required:!0,message:"请输入货物体积",trigger:["change","blur"]}]},oriLatAndLng:{},destLatAndLng:{}}},watch:{"tForm.storageName":{handler:function(t,e){var a=this;if(t){var r={address:t};Object(o.d)(r).then((function(t){200===t.code&&(a.oriLatAndLng={lng:t.data.lng,lat:t.data.lat},a.destLatAndLng={lng:t.data.lng,lat:t.data.lat},a.tForm.oriProvinceName=t.data.province||t.data.country,a.tForm.oriCityName=t.data.city,a.tForm.destProvinceName=t.data.province||t.data.country,a.tForm.destCityName=t.data.city,a.$store.commit("SET_SINGLE_LOCATION",[Object(i.a)(Object(i.a)({},a.oriLatAndLng),{},{transportType:"shop"})]))}))}else this.$store.commit("SET_SINGLE_LOCATION",[])}}},mounted:function(){var t=this;if(this.id){this.$store.commit("SET_RESULT_INFO",this.id);var e=this.$store.getters.getResultItem;this.$set(this,"tForm",e),this.oriLatAndLng=oriLatAndLng||{},this.destLatAndLng=destLatAndLng||{};var a={lng:this.oriLatAndLng.lng,lat:this.oriLatAndLng.lat,transportType:"shop"};this.$store.commit("SET_SINGLE_LOCATION",[a])}else{var r=this.$store.getters.getGoodsInfo||{};this.tForm.cargoVolume=r.volume}Object(s.c)("tjsq_storage_type").then((function(e){t.storageTypeList=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))}))},methods:{formatNumberDeci:l.formatNumberDeci,submit:function(){var t=this;return Object(n.a)(Object(r.a)().mark((function e(){var a,n,s,l;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$refs.tForm.validate();case 4:return a={storageName:t.tForm.storageName,storageType:t.tForm.storageType,cargoVolume:t.tForm.cargoVolume,logisticsStage:t.tForm.logisticsStage,logisticsStationType:t.tForm.logisticsStationType},e.next=8,Object(o.f)(a);case 8:if(200!==(n=e.sent).code){e.next=18;break}return s=Object(i.a)(Object(i.a)({},t.tForm),{},{id:n.data.id,distance:n.data.distance||0,carbonEmissionQty:n.data.emission,cateNo:t.cateNo,oriLatAndLng:t.oriLatAndLng,destLatAndLng:t.destLatAndLng}),e.next=13,new Promise((function(e,a){t.$emit("saveMap2Image",e,a)}));case 13:(l=e.sent)&&(s.imgSrc=l),"add"===t.type?t.$store.commit("SET_RESULT_LIST",s):"edit"===t.type&&t.$store.commit("EDIT_RESULT_LIST",{data:s,originId:t.id}),t.$router.replace({name:"carbonResult"});case 18:t.loading=!1,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),t.loading=!1;case 24:case"end":return e.stop()}}),e,null,[[0,21]])})))()},reset:function(){this.resetForm("tForm")},changeStorageType:function(t){var e=this.storageTypeList.find((function(e){return e.value===t}));e&&(this.tForm.storageTypeLabel=e.label)}}},u=c,d=(a("8cc4"),a("2877")),m=Object(d.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"road-transport"},[a("el-form",{ref:"tForm",attrs:{model:t.tForm,rules:t.rules,inline:!0}},["read"===t.type?a("div",{staticClass:"carbon-info"},[a("div",{staticClass:"carbon-title-box"},[a("div",{staticClass:"left"},[a("p",[t._v(" 里程："),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.distance,3)))]),a("span",{staticClass:"unit"},[t._v("km")])])]),a("div",{staticClass:"right"},[a("p",[t._v(" 温室气体排放:"),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.carbonEmissionQty,3)))]),a("span",{staticClass:"unit"},[t._v("kg")])])])]),a("el-divider")],1):t._e(),a("el-form-item",{attrs:{label:"仓库位置",prop:"storageName"}},[a("el-input",{attrs:{placeholder:"请输入仓库详细地址",disabled:"read"===t.type},model:{value:t.tForm.storageName,callback:function(e){t.$set(t.tForm,"storageName",e)},expression:"tForm.storageName"}})],1),a("el-form-item",{attrs:{label:"仓库类型",prop:"storageType"}},[a("el-select",{attrs:{placeholder:"请选择仓库类型",disabled:"read"===t.type},on:{change:t.changeStorageType},model:{value:t.tForm.storageType,callback:function(e){t.$set(t.tForm,"storageType",e)},expression:"tForm.storageType"}},t._l(t.storageTypeList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"货物体积",prop:"cargoVolume"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入货物体积",disabled:""},model:{value:t.tForm.cargoVolume,callback:function(e){t.$set(t.tForm,"cargoVolume",e)},expression:"tForm.cargoVolume"}},[a("template",{slot:"append"},[t._v("m³")])],2)],1)],1),"read"!==t.type?a("div",{staticClass:"footer-btns"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交并测算")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"pain"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1):t._e()],1)}),[],!1,null,"36b42824",null);e.default=m.exports},2545:function(t,e,a){},"2ace":function(t,e,a){},"2c5a":function(t,e,a){"use strict";a.r(e);var r=a("c7eb"),n=a("1da1"),i=(a("7db0"),a("14d9"),a("b0c0"),a("d3b7"),a("a0c5")),o=a("0605"),s=a("738b"),l=a("0f79"),c=a("ab46"),u=a("dbab"),d=a("f9b2"),m=a("cac8"),p=a("aed4"),g=a("eab1"),h=a("abb1"),f={components:{flexibleContainer:i.default,roadTransport:o.default,airTransport:s.default,wareHouse:l.default,railwayTransport:c.default,seaTransport:u.default,baiduMap:g.default,wharfTransport:d.default,stationTransport:m.default,rodeMap:h.default},data:function(){return{cateNo:null,type:"add",id:null}},computed:{title:function(){var t,e=this;return(null===(t=(p.cateNoList||[]).find((function(t){return t.cateNo===e.cateNo})))||void 0===t?void 0:t.name)||""}},methods:{getImage:function(){var t=this;return Object(n.a)(Object(r.a)().mark((function e(){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.baiduMap.saveImage();case 2:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))()},gotoResultList:function(){this.$router.push({name:"carbonResult"})},saveMap2Image:function(t,e){this.getImage().then((function(e){t(e)}))}},mounted:function(){var t=this.$route.query||{},e=t.cateNo,a=t.type,r=t.id,n=t.quick;this.cateNo=e||"",this.id=r,this.type=a||"add",this.quick=n}},b=f,y=(a("08a5"),a("2877")),v=Object(y.a)(b,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"calculator-form"},[a("div",{staticClass:"parent"},["glys"===t.cateNo?a("rodeMap",{ref:"baiduMap"}):a("baiduMap",{ref:"baiduMap"}),a("div",{staticClass:"child"},["read"===t.type?a("div",{staticClass:"back-arrow",on:{click:function(e){return e.stopPropagation(),t.gotoResultList(e)}}},[a("svg-icon",{attrs:{"icon-class":"backArrow"}})],1):t._e(),t.title?a("flexibleContainer",{attrs:{title:t.title}},[a("div",{staticClass:"form-body"},["kyys"===t.cateNo?a("airTransport",{attrs:{cateNo:t.cateNo,type:t.type,id:t.id,quick:t.quick},on:{saveMap2Image:t.saveMap2Image}}):t._e(),"syys"===t.cateNo?a("seaTransport",{attrs:{cateNo:t.cateNo,type:t.type,id:t.id,quick:t.quick},on:{saveMap2Image:t.saveMap2Image}}):t._e(),"tlys"===t.cateNo?a("railwayTransport",{attrs:{cateNo:t.cateNo,type:t.type,id:t.id,quick:t.quick},on:{saveMap2Image:t.saveMap2Image}}):t._e(),"glys"===t.cateNo?a("roadTransport",{attrs:{cateNo:t.cateNo,type:t.type,id:t.id,quick:t.quick},on:{saveMap2Image:t.saveMap2Image}}):t._e(),"mtsy"===t.cateNo?a("wharfTransport",{attrs:{cateNo:t.cateNo,type:t.type,id:t.id},on:{saveMap2Image:t.saveMap2Image}}):t._e(),"czsy"===t.cateNo?a("stationTransport",{attrs:{cateNo:t.cateNo,type:t.type,id:t.id},on:{saveMap2Image:t.saveMap2Image}}):t._e(),"cksy"===t.cateNo?a("wareHouse",{attrs:{cateNo:t.cateNo,type:t.type,id:t.id},on:{saveMap2Image:t.saveMap2Image}}):t._e()],1)]):t._e()],1)],1)])}),[],!1,null,"22c592d9",null);e.default=v.exports},3194:function(t,e,a){},"4b2a":function(t,e,a){},"66a1":function(t,e,a){},"6f53":function(t,e,a){var r=a("83ab"),n=a("e330"),i=a("df75"),o=a("fc6a"),s=n(a("d1e7").f),l=n([].push),c=function(t){return function(e){for(var a,n=o(e),c=i(n),u=c.length,d=0,m=[];u>d;)a=c[d++],r&&!s(n,a)||l(m,t?[a,n[a]]:n[a]);return m}};t.exports={entries:c(!0),values:c(!1)}},"738b":function(t,e,a){"use strict";a.r(e);var r=a("c7eb"),n=a("5530"),i=a("1da1"),o=a("15fd"),s=(a("99af"),a("4de4"),a("7db0"),a("d81d"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("5319"),a("9d44")),l=a("4e9f"),c=a("d8ad"),u=a("aed4"),d=a("ed08"),m=["oriLatAndLng","destLatAndLng"],p={props:{cateNo:{type:String},type:{type:String,default:"add"},id:{type:[String,Number]}},data:function(){return{fuelListOptions:[],loading:!1,tForm:{dest:"",origin:"",originCountry:"",destCountry:"",originAirport:"",destAirport:"",transportDistance:"",transportWeight:"",transportType:3,factorProject:"122",quickCal:!1,actualEnergyConsumption:null},countryList:[{value:"贵阳市人民政府",label:"贵阳市人民政府"},{value:"沈阳森林动物园",label:"沈阳森林动物园"},{value:"广州番禺长隆野生动物世界",label:"广州番禺长隆野生动物世界"},{value:"上海市浦东新区世纪大道1号",label:"上海市浦东新区世纪大道1号"},{value:"广东省广州市海珠区阅江西路222号",label:"广东省广州市海珠区阅江西路222号"}],airportList1:[],airportList2:[{value:"北京机场",label:"北京机场"},{value:"首尔机场",label:"首尔机场"}],rules:{originCountry:[{required:!0,message:"请选择始发地国家",trigger:"change"}],destCountry:[{required:!0,message:"请选择目的地国家",trigger:"change"}],originAirport:[{required:!0,message:"请选择始始发地机场",trigger:"change"}],destAirport:[{required:!0,message:"请选择目的地机场",trigger:"change"}],transportDistance:[{required:!1,message:"请输入空运距离",trigger:"blur"}],transportWeight:[{required:!0,message:"请输入货物重量",trigger:"blur"}]},mutiTrans:!1,oriLatAndLng:{lng:"",lat:""},destLatAndLng:{lng:"",lat:""},queryParams:{pageNum:1,pageSize:10,airportName:null,cityName:null},fuelTypeOptions:[]}},watch:{"tForm.originAirport":{handler:function(t,e){if(t){var a=[Object.assign({},this.tForm,{oriLatAndLng:this.oriLatAndLng,destLatAndLng:this.destLatAndLng,cateNo:this.cateNo})];this.$store.commit("SET_ADDRESS_LIST",Object(u.initPoints)(a).filter((function(t){return t.originLng&&t.originLat&&t.destLng&&t.destLat})))}}},"tForm.destAirport":{handler:function(t,e){if(t){var a=[Object.assign({},this.tForm,{oriLatAndLng:this.oriLatAndLng,destLatAndLng:this.destLatAndLng,cateNo:this.cateNo})];this.$store.commit("SET_ADDRESS_LIST",Object(u.initPoints)(a).filter((function(t){return t.originLng&&t.originLat&&t.destLng&&t.destLat})))}}},preTransportItem:{handler:function(t){t&&(this.queryParams.cityName=Object(d.e)(t))},immediate:!0}},computed:{getMutiTransport:function(){return this.$store.getters.getMutiTransport},preTransportItem:function(){var t=this.$route.query,e=t.type,a=t.id,r=this.$store.getters.getResultList;return Object(u.getPreTransportItem)(r,a,e)}},mounted:function(){var t=this;if(this.getPowerAndFuel(),this.mutiTrans=!!this.$route.params.mutiTrans,this.id){this.$store.commit("SET_RESULT_INFO",this.id);var e=this.$store.getters.getResultItem,a=e.oriLatAndLng,r=e.destLatAndLng,n=Object(o.a)(e,m);this.$set(this,"tForm",n),this.oriLatAndLng=a,this.destLatAndLng=r;var i=[Object.assign({},this.tForm,{oriLatAndLng:a,destLatAndLng:r,cateNo:this.cateNo})];this.$store.commit("SET_ADDRESS_LIST",Object(u.initPoints)(i))}else if("add"===this.type){var s=this.$store.getters.getGoodsInfo||{};this.tForm.transportWeight=s.weight}Object(l.c)("tjsq_air_fast_fuel_type").then((function(e){t.fuelTypeOptions=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))}))},methods:{valKgToTWithDecimals:d.j,unitKgToT:d.i,formatNumberDeci:u.formatNumberDeci,checkBoxChange:function(){this.tForm.quickCal&&(this.tForm.dest="",this.tForm.origin="",this.tForm.originCountry="",this.tForm.destCountry="",this.tForm.originAirport="",this.tForm.destAirport="",this.tForm.transportDistance="",this.$store.commit("INIT_FINAL_IMG"))},handleChange:function(){var t=this;this.tForm.powerType=this.tForm.fuelTypeItem[0],this.tForm.fuelType=this.tForm.fuelTypeItem[1];var e=this.fuelListOptions.find((function(e){return e.value==t.tForm.powerType})),a=e.label,r=e.children.find((function(e){return e.value==t.tForm.fuelType})).label;this.tForm.powerOrFuelName=a+"/"+r},getPowerAndFuel:function(){var t=this;return Object(i.a)(Object(r.a)().mark((function e(){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.g)();case 2:a=e.sent,t.fuelListOptions=a.data.map((function(t){return Object(n.a)({children:t.subFuelVOList},t)}));case 4:case"end":return e.stop()}}),e)})))()},validatorPosition:function(){},setMapPoint:function(){return Object(u.initPoints)([this.tForm])},submit:function(){var t=this;return Object(i.a)(Object(r.a)().mark((function e(){var a,i,o,l,c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$refs.tForm.validate();case 4:if(a={originAirport:t.tForm.originAirport,destAirport:t.tForm.destAirport,factorProject:t.tForm.factorProject,transportWeight:Number(t.tForm.transportWeight),transportType:3},i=null,!t.tForm.quickCal){e.next=14;break}return o={transportType:5,powerType:t.tForm.powerType,fuelType:t.tForm.fuelType,actualEnergyConsumption:t.tForm.actualEnergyConsumption,factorProject:t.tForm.factorProject},e.next=11,Object(s.h)(o);case 11:i=e.sent,e.next=17;break;case 14:return e.next=16,Object(s.a)(a);case 16:i=e.sent;case 17:if(200!==i.code){e.next=26;break}return l=Object(n.a)(Object(n.a)({},t.tForm),{},{id:i.data.id||999,distance:i.data.distance,carbonEmissionQty:i.data.carbonEmissionQty,cateNo:t.cateNo,oriLatAndLng:t.oriLatAndLng,destLatAndLng:t.destLatAndLng}),e.next=21,new Promise((function(e,a){t.$emit("saveMap2Image",e,a)}));case 21:(c=e.sent)&&(l.imgSrc=c),"add"===t.type?t.$store.commit("SET_RESULT_LIST",l):"edit"===t.type&&t.$store.commit("EDIT_RESULT_LIST",{data:l,originId:t.id}),t.$router.replace({name:"carbonResult"});case 26:t.loading=!1,e.next=33;break;case 29:e.prev=29,e.t0=e.catch(0),t.loading=!1;case 33:case"end":return e.stop()}}),e,null,[[0,29]])})))()},destCountryChange:function(t){c.a.$emit("destlocation",t)},originCountryChange:function(t){c.a.$emit("originlocation",t)},reset:function(){Object.assign(this.tForm,{origin:null,dest:null,originCountry:"",destCountry:"",originAirport:"",destAirport:"",transportDistance:""})},changeOriAirport:function(t){var e=this.airportList1.find((function(e){return e.label===t}));e&&(this.tForm.originAirport=e.value,this.oriLatAndLng.lng=e.lng,this.oriLatAndLng.lat=e.lat,this.tForm.oriProvinceName=e.province,this.tForm.oriCityName=e.city,this.tForm.originCountry=e.regionName,this.tForm.oriLabel=e.name,this.tForm.oriSubLabel=e.regionName)},changeDestAirport:function(t){var e=this.airportList2.find((function(e){return e.label===t}));e&&(this.tForm.destAirport=e.value,this.destLatAndLng.lng=e.lng,this.destLatAndLng.lat=e.lat,this.tForm.destProvinceName=e.province,this.tForm.destCityName=e.city,this.tForm.destCountry=e.regionName,this.tForm.destLabel=e.name,this.tForm.destSubLabel=e.regionName)},resetQuery1:function(t){this.queryParams.pageNum=1,this.queryParams.airportName=t||"",this.airportList1=[]},remoteOriAirport:function(t){this.resetQuery1(t),this.handleLazyload1()},handleLazyload1:function(){var t=this;return Object(i.a)(Object(r.a)().mark((function e(){var a,n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,n=[],!t.queryParams.cityName){e.next=11;break}return e.next=5,Object(l.a)(t.queryParams.cityName);case 5:if(200===(a=e.sent).code){e.next=8;break}return e.abrupt("return");case 8:n=a.data.map((function(t){return{id:t.id,label:t.name,value:t.iataCode,lng:t.lng,lat:t.lat,regionName:t.regionName,province:t.province,city:t.city,name:t.name}})),e.next=17;break;case 11:return e.next=13,Object(l.b)(t.queryParams);case 13:if(200===(a=e.sent).code){e.next=16;break}return e.abrupt("return");case 16:n=a.rows.map((function(t){return{id:t.id,label:t.name,value:t.iataCode,lng:t.lng,lat:t.lat,regionName:t.regionName,province:t.province,city:t.city,name:t.name}}));case 17:if(t.airportList1=t.airportList1.concat(n),0!==n.length){e.next=22;break}return e.abrupt("return");case 22:t.queryParams.pageNum++;case 23:case"end":return e.stop()}}),e)})))()},handleSelectVisible1:function(t){t&&this.remoteOriAirport()},resetQuery2:function(t){this.queryParams.pageNum=1,this.queryParams.airportName=t||"",this.airportList2=[]},remoteDestAirport:function(t){this.resetQuery2(t),this.handleLazyload2()},handleLazyload2:function(){var t=this;return Object(i.a)(Object(r.a)().mark((function e(){var a,n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.b)(t.queryParams);case 2:if(200===(a=e.sent).code){e.next=5;break}return e.abrupt("return");case 5:if(n=a.rows.map((function(t){return{id:t.id,label:t.name,value:t.iataCode,lng:t.lng,lat:t.lat,regionName:t.regionName,province:t.province,city:t.city,name:t.name}})),t.airportList2=t.airportList2.concat(n),0!==n.length){e.next=11;break}return e.abrupt("return");case 11:t.queryParams.pageNum++;case 12:case"end":return e.stop()}}),e)})))()},handleSelectVisible2:function(t){t&&this.remoteDestAirport()},changeFuelType:function(t){var e=this.fuelTypeOptions.find((function(e){return e.value===t}));this.tForm.powerOrFuelName=e.label}}},g=p,h=(a("9e51"),a("2877")),f=Object(h.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"road-transport"},[a("el-form",{ref:"tForm",attrs:{model:t.tForm,rules:t.rules,inline:!0}},["read"===t.type?a("div",{staticClass:"carbon-info"},[a("div",{staticClass:"carbon-title-box"},[a("div",{staticClass:"left"},[a("p",[t._v(" 里程："),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.distance,3)))]),a("span",{staticClass:"unit"},[t._v("km")])])]),a("div",{staticClass:"right"},[a("p",[t._v(" 温室气体排放:"),a("em",[t._v(t._s(t.valKgToTWithDecimals(t.tForm.carbonEmissionQty,5)))]),a("span",{staticClass:"unit"},[t._v(t._s(t.unitKgToT(t.tForm.carbonEmissionQty,5)))])])])]),a("el-divider")],1):t._e(),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"始发地机场",prop:t.tForm.quickCal?"":"originAirport"}},[a("el-select",{directives:[{name:"elSelectLazyloading",rawName:"v-elSelectLazyloading",value:{handleLazyload:t.handleLazyload1},expression:"{ handleLazyload: handleLazyload1 }"}],attrs:{placeholder:"请选择始发地机场",disabled:"read"===t.type||t.tForm.quickCal,filterable:"",remote:"","remote-method":t.remoteOriAirport},on:{change:t.changeOriAirport,"visible-change":t.handleSelectVisible1},model:{value:t.tForm.origin,callback:function(e){t.$set(t.tForm,"origin",e)},expression:"tForm.origin"}},t._l(t.airportList1,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"目的地机场",prop:t.tForm.quickCal?"":"destAirport"}},[a("el-select",{directives:[{name:"elSelectLazyloading",rawName:"v-elSelectLazyloading",value:{handleLazyload:t.handleLazyload2},expression:"{ handleLazyload: handleLazyload2 }"}],attrs:{placeholder:"请选择目的地机场",disabled:"read"===t.type||t.tForm.quickCal,filterable:"",remote:"","remote-method":t.remoteDestAirport},on:{change:t.changeDestAirport,"visible-change":t.handleSelectVisible2},model:{value:t.tForm.dest,callback:function(e){t.$set(t.tForm,"dest",e)},expression:"tForm.dest"}},t._l(t.airportList2,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1)],1)],1),a("el-divider"),t.getMutiTransport?t._e():a("el-form-item",{attrs:{label:""}},[a("el-checkbox",{attrs:{disabled:"read"===t.type},on:{change:t.checkBoxChange},model:{value:t.tForm.quickCal,callback:function(e){t.$set(t.tForm,"quickCal",e)},expression:"tForm.quickCal"}},[t._v("采取能耗速算")])],1),a("el-col",{attrs:{span:24}},[t.tForm.quickCal?a("el-form-item",{attrs:{label:"燃料类型",prop:"fuelTypeItem"}},[a("el-select",{attrs:{placeholder:"请选择燃料类型",disabled:"read"===t.type},on:{change:t.changeFuelType},model:{value:t.tForm.fuelType,callback:function(e){t.$set(t.tForm,"fuelType",e)},expression:"tForm.fuelType"}},t._l(t.fuelTypeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1):t._e()],1),t.tForm.quickCal?a("el-form-item",{attrs:{label:"实际能耗",prop:"actualEnergyConsumption"}},[a("el-input",{attrs:{placeholder:"请输入货物运输重量",type:"number",step:"0.01",disabled:"read"===t.type},model:{value:t.tForm.actualEnergyConsumption,callback:function(e){t.$set(t.tForm,"actualEnergyConsumption",e)},expression:"tForm.actualEnergyConsumption"}},[a("template",{slot:"append"},[t._v("L")])],2)],1):t._e(),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},["read"!==t.type||t.tForm.quickCal?t._e():a("el-form-item",{attrs:{label:"空运距离",prop:"transportDistance"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入空运距离",disabled:"read"===t.type},model:{value:t.tForm.distance,callback:function(e){t.$set(t.tForm,"distance",e)},expression:"tForm.distance"}},[a("template",{slot:"append"},[t._v("km")])],2)],1)],1),a("el-col",{attrs:{span:12}},[t.tForm.quickCal?t._e():a("el-form-item",{attrs:{label:"货物重量",prop:"transportWeight"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入货物重量",disabled:!0},model:{value:t.tForm.transportWeight,callback:function(e){t.$set(t.tForm,"transportWeight",e)},expression:"tForm.transportWeight"}},[a("template",{slot:"append"},[t._v("kg")])],2)],1)],1)],1)],1),"read"!==t.type?a("div",{staticClass:"footer-btns"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交并测算")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"pain"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1):t._e()],1)}),[],!1,null,"31c7949e",null);e.default=f.exports},"78b9":function(t,e,a){},"8cc4":function(t,e,a){"use strict";a("66a1")},"9c86":function(t,e,a){},"9e51":function(t,e,a){"use strict";a("9c86")},ab46:function(t,e,a){"use strict";a.r(e);var r=a("5530"),n=a("c7eb"),i=a("1da1"),o=a("15fd"),s=(a("99af"),a("4de4"),a("7db0"),a("d81d"),a("14d9"),a("a9e3"),a("b64b"),a("d3b7"),a("07ac"),a("ac1f"),a("466d"),a("5319"),a("159b"),a("9d44")),l=a("4e9f"),c=a("aed4"),u=a("ed08"),d=a("4360");var m=["oriLatAndLng","midLatAndLng","destLatAndLng"],p={props:{cateNo:{type:String},id:{type:[String,Number]},type:{type:String,default:"add"},quick:{type:Boolean,default:!1}},data:function(){return{cacheDestCity:null,cacheOriCity:null,projectListOption:[],fuelListOptions:null,loading:!1,tForm:{origin:null,dest:null,powerType:null,fuelType:null,freightStation:null,transportWeight:null,transportType:6,factorProject:"122",quickCal:!1,powerOrFuelName:"",actualEnergyConsumption:null},originOptions:[{label:"测试始发站",value:636440}],freightStationOptions:[{label:"⼆连境",value:1},{label:"满洲⾥境",value:2},{label:"阿拉⼭⼝境",value:3},{label:"霍尔果斯境",value:4}],destOptions:[{label:"测试目的站",value:950807}],fuelTypeOptions:[],rules:{origin:[{required:!0,message:"请选择始发地",trigger:"change"}],dest:[{required:!0,message:"请选择目的地",trigger:"change"}],fuelType:[{required:!0,message:"请选择燃料油类型",trigger:"change"}],fuelTypeItem:[{required:!0,message:"请选择动力/燃料油类型",trigger:"change"}],transportWeight:[{required:!0,message:"请输入货物重量",trigger:"blur"}]},queryParams:{pageNum:1,pageSize:30,stationName:null},oriLatAndLng:{},midLatAndLng:{},destLatAndLng:{},stationList1:[],stationList2:[],stationList3:[]}},watch:{"tForm.origin":{handler:function(t,e){t&&this.handlePoints()}},"tForm.freightStation":{handler:function(t,e){var a=this;t&&this.changeMidStation(t).then((function(t){a.handlePoints()}))}},"tForm.dest":{handler:function(t,e){t&&this.handlePoints()}},preTransportItem:{handler:function(t){},immediate:!0}},computed:{getConsumptionUnit:function(){return this.tForm.powerOrFuelName&&this.tForm.powerOrFuelName.match("电")?"kWh":"L"},getMutiTransport:function(){return this.$store.getters.getMutiTransport},preTransportItem:function(){if(!this.$route.query.type){var t=null,e=this.$store.getters.getResultList;return e&&e.length>0&&(t=e[e.length-1]),t}if(!this.$route.query.id)return null}},mounted:function(){var t=this;if(this.getPowerAndFuel(),this.getFactorProjectList(),this.id){this.$store.commit("SET_RESULT_INFO",this.id);var e=this.$store.getters.getResultItem,a=e.oriLatAndLng,r=e.midLatAndLng,n=e.destLatAndLng,i=Object(o.a)(e,m);if(this.$set(this,"tForm",i),!0!==this.quick){this.oriLatAndLng=a,this.midLatAndLng=r,this.destLatAndLng=n,this.stationList1.push(this.tForm.oriOptionItem),this.stationList2.push(this.tForm.midOptionItem),this.stationList3.push(this.tForm.desOptionItem);var s=function(t){var e=d.a.getters.getResultList,a=e.length,r=Object(u.d)(e,{id:t},"id"),n=r.location;return r.hasObj,n+1===a}(this.$route.query.id),c=function(t){var e=d.a.getters.getResultList,a=Object(u.d)(e,{id:t},"id"),r=a.location;return a.hasObj,0===r}(this.$route.query.id);s||(this.cacheDestCity=this.tForm.destCityName),c||(this.cacheOriCity=this.tForm.oriCityName)}}else if("add"===this.type){var p=this.$store.getters.getGoodsInfo||{};this.tForm.transportWeight=p.weight}Object(l.c)("tjsq_railway_fast_fuel_type").then((function(e){t.fuelTypeOptions=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))})),Object(l.c)("tjsq_freight_station").then((function(e){t.stationList2=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))})),Object(l.c)("tjsq_railway_fast_fuel_type").then((function(e){t.qucikFuelTypeOptions=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))}))},methods:{valKgToTWithDecimals:u.j,unitKgToT:u.i,formatNumberDeci:c.formatNumberDeci,checkBoxChange:function(){this.tForm.quickCal&&(this.tForm.origin="",this.tForm.dest="",this.tForm.freightStation="",this.$refs.tForm.clearValidate(),this.$store.commit("INIT_FINAL_IMG")),this.tForm.fuelType=null,this.tForm.powerType=null,this.tForm.fuelTypeItem=[]},getFactorProjectList:function(){var t=this;return Object(i.a)(Object(n.a)().mark((function e(){var a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.d)();case 2:200===(a=e.sent).code&&(t.projectListOption=a.data);case 4:case"end":return e.stop()}}),e)})))()},handleChange:function(){var t=this;this.tForm.powerType=this.tForm.fuelTypeItem[0],this.tForm.fuelType=this.tForm.fuelTypeItem[1];var e=this.fuelListOptions.find((function(e){return e.value==t.tForm.powerType})),a=e.label,r=e.children.find((function(e){return e.value==t.tForm.fuelType})).label;this.tForm.powerOrFuelName=a+"/"+r},getPowerAndFuel:function(){var t=this;return Object(i.a)(Object(n.a)().mark((function e(){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.g)();case 2:e.sent.data.forEach((function(e){if(1==e.value){var a=Object(r.a)(Object(r.a)({},e),{},{children:e.subFuelVOList.filter((function(t){return 10==t.value}))});t.fuelListOptions=[a]}}));case 4:case"end":return e.stop()}}),e)})))()},handlePoints:function(){var t=[],e=Object.keys(this.midLatAndLng).length&&Object.values(this.midLatAndLng).every((function(t){return t})),a=Object.keys(this.destLatAndLng).length&&Object.values(this.destLatAndLng).every((function(t){return t}));e&&t.push({oriLatAndLng:this.oriLatAndLng,destLatAndLng:this.midLatAndLng,cateNo:this.cateNo}),a&&t.push({oriLatAndLng:e?this.midLatAndLng:this.oriLatAndLng,destLatAndLng:this.destLatAndLng,cateNo:this.cateNo}),this.$store.commit("SET_ADDRESS_LIST",Object(c.initPoints)(t).filter((function(t){return t.originLng&&t.originLat&&t.destLng&&t.destLat})))},searchCityByLng:function(t){var e=this;return Object(i.a)(Object(n.a)().mark((function a(){var r,i;return Object(n.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=t.lng,i=t.lat,a.next=4,e.$parent.$parent.$refs.baiduMap.getCityByLng({lng:r,lat:i});case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}}),a)})))()},checkPosition:function(t,e){var a=this;return Object(i.a)(Object(n.a)().mark((function r(){var i,o,s,l,c;return Object(n.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!0,!e){r.next=17;break}if(!t.lng||!t.lat){r.next=13;break}return o=t.lng,s=t.lat,r.next=8,a.searchCityByLng({lng:o,lat:s});case 8:l=r.sent,c=l.addressComponents.city,i=c===e,r.next=15;break;case 13:i=!1;case 15:r.next=18;break;case 17:i=!0;case 18:return r.abrupt("return",i);case 20:case"end":return r.stop()}}),r)})))()},validateStation:function(){var t=this;return Object(i.a)(Object(n.a)().mark((function e(){var a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,!t.$route.query.id){e.next=7;break}return e.next=4,t.checkEditRight();case 4:a=e.sent,e.next=10;break;case 7:return e.next=9,t.checkAddRight(t.oriLatAndLng);case 9:a=e.sent;case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))()},savePositionCity:function(t){var e=this;return Object(i.a)(Object(n.a)().mark((function a(){var r,i,o,l,c,u,d,m,p,g,h,f;return Object(n.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.data.originLocation){a.next=11;break}return r=t.data.originLocation.split(",")[0],i=t.data.originLocation.split(",")[1],a.next=5,e.searchCityByLng({lng:r,lat:i});case 5:o=a.sent,e.tForm.oriCityName=o.addressComponents.city,e.tForm.originProvinceName=o.addressComponents.province,a.next=23;break;case 11:if(!e.tForm.oriCityName){a.next=22;break}return l={address:e.tForm.oriCityName},a.next=15,Object(s.d)(l);case 15:(c=a.sent).code,u=c.data,e.tForm.oriCityName=u.city,e.tForm.originProvinceName=u.province,a.next=23;break;case 22:case 23:if(!t.data.destLocation){a.next=33;break}return d=t.data.destLocation.split(",")[0],m=t.data.destLocation.split(",")[1],a.next=28,e.searchCityByLng({lng:d,lat:m});case 28:p=a.sent,e.tForm.destCityName=p.addressComponents.city,e.tForm.destProvinceName=p.addressComponents.province,a.next=46;break;case 33:if(!e.tForm.destCityName){a.next=45;break}return g={address:e.tForm.destCityName},a.next=37,Object(s.d)(g);case 37:(h=a.sent).code,f=h.data,e.tForm.destCityName=f.city,e.tForm.destCountry=f.country,e.tForm.destProvinceName=f.province,a.next=46;break;case 45:case 46:case"end":return a.stop()}}),a)})))()},checkAddRight:function(t){var e=this;return Object(i.a)(Object(n.a)().mark((function a(){var r;return Object(n.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=!0,!e.preTransportItem||!e.preTransportItem.destCityName){a.next=7;break}return a.next=5,e.checkPosition(t,e.preTransportItem.destCityName);case 5:a.sent?r=!0:(e.$message.warning("始发地与上一运输环节目的地不同，请检查。"),e.loading=!1,r=!1);case 7:return a.abrupt("return",r);case 8:case"end":return a.stop()}}),a)})))()},checkEditRight:function(){var t=this;return Object(i.a)(Object(n.a)().mark((function e(){var a,r,i;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,!t.cacheOriCity){e.next=9;break}return e.next=6,t.checkPosition(t.oriLatAndLng,t.cacheOriCity);case 6:r=e.sent,a=a&&r,r||t.$message.warning("多式联运中间运输环节始发地城市不可更改");case 9:if(!t.cacheDestCity){e.next=15;break}return e.next=12,t.checkPosition(t.destLatAndLng,t.cacheDestCity);case 12:i=e.sent,a=a&&i,i||t.$message.warning("多式联运中间运输环节目的地城市不可更改");case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;return Object(i.a)(Object(n.a)().mark((function e(){var a,i,o,l,c;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$refs.tForm.validate();case 4:if(a={origin:t.tForm.origin,dest:t.tForm.dest,freightStation:t.tForm.freightStation,fuelType:t.tForm.fuelType,transportWeight:t.tForm.transportWeight,factorProject:t.tForm.factorProject,transportType:t.tForm.transportType},i=null,!t.tForm.quickCal){e.next=15;break}return o={transportType:7,fuelType:10,actualEnergyConsumption:t.tForm.actualEnergyConsumption,factorProject:t.tForm.factorProject},e.next=12,Object(s.h)(o);case 12:i=e.sent,e.next=24;break;case 15:return e.next=17,t.validateStation();case 17:if(e.sent){e.next=21;break}return t.loading=!1,e.abrupt("return");case 21:return e.next=23,Object(s.i)(a);case 23:i=e.sent;case 24:return e.prev=24,e.next=27,t.savePositionCity(i);case 27:e.next=31;break;case 29:e.prev=29,e.t0=e.catch(24);case 31:if(200!==i.code){e.next=40;break}return l=Object(r.a)(Object(r.a)({},t.tForm),{},{id:i.data.id,distance:i.data.distance,carbonEmissionQty:i.data.carbonEmissionQty,cateNo:t.cateNo,oriLatAndLng:t.oriLatAndLng,midLatAndLng:t.midLatAndLng,destLatAndLng:t.destLatAndLng}),e.next=35,new Promise((function(e,a){t.$emit("saveMap2Image",e,a)}));case 35:(c=e.sent)&&(l.imgSrc=c),"add"===t.type?t.$store.commit("SET_RESULT_LIST",l):"edit"===t.type&&t.$store.commit("EDIT_RESULT_LIST",{data:l,originId:t.id}),t.$router.replace({name:"carbonResult"});case 40:t.loading=!1,e.next=46;break;case 43:e.prev=43,e.t1=e.catch(0),t.loading=!1;case 46:case"end":return e.stop()}}),e,null,[[0,43],[24,29]])})))()},reset:function(){Object.assign(this.tForm,{origin:null,dest:null,fuelType:null,freightStation:null})},resetQuery:function(t,e){this.queryParams.pageNum=1,this.queryParams.stationName=t||"",this["stationList"+e]=[]},remoteStation:function(t,e){this.resetQuery(t,e),this.handleLazyload(e)},handleLazyload:function(t){var e=this;return Object(i.a)(Object(n.a)().mark((function a(){var r,i;return Object(n.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(l.h)(e.queryParams);case 2:if(200===(r=a.sent).code){a.next=5;break}return a.abrupt("return");case 5:if(i=r.rows.map((function(t){return{label:t.nationalNameChn,value:t.railwayStationCode,lng:t.longitude,lat:t.latitude,countryName:t.countryName,nationalNameChn:t.nationalNameChn}})),e["stationList"+t]=e["stationList"+t].concat(i),0!==i.length){a.next=11;break}return a.abrupt("return");case 11:e.queryParams.pageNum++;case 12:case"end":return a.stop()}}),a)})))()},handleSelectVisible:function(t,e){t&&this.remoteStation("",e)},changeStation:function(t,e){var a=this;return Object(i.a)(Object(n.a)().mark((function r(){var i,o;return Object(n.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:"1"===e?(i=a.stationList1.find((function(e){return e.value===t})),i&&(a.oriLatAndLng.lng=i.lng,a.oriLatAndLng.lat=i.lat,a.tForm.oriOptionItem=i,a.tForm.originCountry=i.countryName,a.tForm.oriLabel=i.nationalNameChn,a.tForm.oriSubLabel=i.countryName)):"3"===e&&(o=a.stationList3.find((function(e){return e.value===t})),o&&(a.destLatAndLng.lng=o.lng,a.destLatAndLng.lat=o.lat,a.tForm.desOptionItem=o,a.tForm.destCountry=o.countryName,a.tForm.destLabel=o.nationalNameChn,a.tForm.destSubLabel=o.countryName));case 2:case"end":return r.stop()}}),r)})))()},changeMidStation:function(t){var e=this;return Object(i.a)(Object(n.a)().mark((function a(){var r,i;return Object(n.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(r=e.stationList2.find((function(e){return e.value===t})))){a.next=5;break}return i={pageNum:1,pageSize:10,stationName:r.label},a.next=5,Object(l.h)(i).then((function(t){if(200===t.code){var a=t.rows.map((function(t){return{label:t.nationalNameChn,value:t.railwayStationCode,lng:t.longitude,lat:t.latitude,countryName:t.countryName,nationalNameChn:t.nationalNameChn}}))[0];a&&(e.freightStationLabel=a.label,e.midLatAndLng.lng=a.lng,e.midLatAndLng.lat=a.lat,e.tForm.midProvinceName=a.province,e.tForm.midCityName=a.city)}}));case 5:case"end":return a.stop()}}),a)})))()},changeFuelType:function(t){var e=this.fuelTypeOptions.find((function(e){return e.value===t}));this.tForm.powerOrFuelName=e.label}}},g=p,h=(a("b20d"),a("2877")),f=Object(h.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"road-transport"},[a("el-form",{ref:"tForm",attrs:{model:t.tForm,rules:t.rules,inline:!0}},["read"===t.type?a("div",{staticClass:"carbon-info"},[a("div",{staticClass:"carbon-title-box"},[a("div",{staticClass:"left"},[a("p",[t._v(" 里程："),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.distance,3)))]),a("span",{staticClass:"unit"},[t._v("km")])])]),a("div",{staticClass:"right"},[a("p",[t._v(" 温室气体排放:"),a("em",[t._v(t._s(t.valKgToTWithDecimals(t.tForm.carbonEmissionQty,5)))]),a("span",{staticClass:"unit"},[t._v(t._s(t.unitKgToT(t.tForm.carbonEmissionQty,5)))])])])]),a("el-divider")],1):t._e(),a("el-form-item",{attrs:{label:"始发地",prop:t.tForm.quickCal?"":"origin"}},[a("el-select",{directives:[{name:"elSelectLazyloading",rawName:"v-elSelectLazyloading",value:{handleLazyload:function(){return t.handleLazyload("1")}},expression:"{\n            handleLazyload: () => handleLazyload('1'),\n          }"}],attrs:{placeholder:"请选择始发地",disabled:"read"===t.type||t.tForm.quickCal,filterable:"",remote:"","remote-method":function(e){return t.remoteStation(e,"1")}},on:{change:function(e){return t.changeStation(e,"1")},"visible-change":function(e){return t.handleSelectVisible(e,"1")}},model:{value:t.tForm.origin,callback:function(e){t.$set(t.tForm,"origin",e)},expression:"tForm.origin"}},t._l(t.stationList1,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"途经点（出境口岸）",prop:"freightStation"}},[a("el-select",{attrs:{placeholder:"请选择途经点",disabled:"read"===t.type||t.tForm.quickCal,filterable:"",clearable:""},model:{value:t.tForm.freightStation,callback:function(e){t.$set(t.tForm,"freightStation",e)},expression:"tForm.freightStation"}},t._l(t.stationList2,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"目的地",prop:t.tForm.quickCal?"":"dest"}},[a("el-select",{directives:[{name:"elSelectLazyloading",rawName:"v-elSelectLazyloading",value:{handleLazyload:function(){return t.handleLazyload("3")}},expression:"{\n            handleLazyload: () => handleLazyload('3'),\n          }"}],attrs:{placeholder:"请选择目的地",disabled:"read"===t.type||t.tForm.quickCal,filterable:"",remote:"","remote-method":function(e){return t.remoteStation(e,"3")}},on:{change:function(e){return t.changeStation(e,"3")},"visible-change":function(e){return t.handleSelectVisible(e,"3")}},model:{value:t.tForm.dest,callback:function(e){t.$set(t.tForm,"dest",e)},expression:"tForm.dest"}},t._l(t.stationList3,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t.getMutiTransport?t._e():a("el-form-item",{attrs:{label:""}},[a("el-checkbox",{attrs:{disabled:"read"===t.type},on:{change:t.checkBoxChange},model:{value:t.tForm.quickCal,callback:function(e){t.$set(t.tForm,"quickCal",e)},expression:"tForm.quickCal"}},[t._v("采取能耗速算")])],1),a("el-col",{attrs:{span:24}},[t.tForm.quickCal?a("el-form-item",{attrs:{label:"燃料类型",prop:"fuelType"}},[a("el-select",{attrs:{placeholder:"请选择燃料类型",disabled:"read"===t.type},on:{change:t.changeFuelType},model:{value:t.tForm.fuelType,callback:function(e){t.$set(t.tForm,"fuelType",e)},expression:"tForm.fuelType"}},t._l(t.fuelTypeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1):a("el-form-item",{attrs:{label:"动力/燃料类型",prop:"fuelTypeItem"}},[a("el-cascader",{attrs:{options:t.fuelListOptions,props:{expandTrigger:"hover"},disabled:"read"===t.type},on:{change:t.handleChange},model:{value:t.tForm.fuelTypeItem,callback:function(e){t.$set(t.tForm,"fuelTypeItem",e)},expression:"tForm.fuelTypeItem"}})],1)],1),t.tForm.quickCal?a("el-form-item",{attrs:{label:"实际能耗",prop:"actualEnergyConsumption"}},[a("el-input",{attrs:{placeholder:"请输入实际能耗",type:"number",step:"0.01",disabled:"read"===t.type},model:{value:t.tForm.actualEnergyConsumption,callback:function(e){t.$set(t.tForm,"actualEnergyConsumption",e)},expression:"tForm.actualEnergyConsumption"}},[a("template",{slot:"append"},[t._v(t._s(t.getConsumptionUnit))])],2)],1):t._e(),t.tForm.quickCal?t._e():a("el-form-item",{attrs:{label:"货物重量",required:"",prop:"transportWeight"}},[a("el-input",{attrs:{placeholder:"请输入货物重量",disabled:!0},model:{value:t.tForm.transportWeight,callback:function(e){t.$set(t.tForm,"transportWeight",e)},expression:"tForm.transportWeight"}},[a("template",{slot:"append"},[t._v("kg")])],2)],1)],1),"read"!==t.type?a("div",{staticClass:"footer-btns"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交并测算")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"pain"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1):t._e()],1)}),[],!1,null,"6479cf40",null);e.default=f.exports},abb1:function(t,e,a){"use strict";a.r(e);var r,n=a("c7eb"),i=a("1da1"),o=(a("a630"),a("d81d"),a("d3b7"),a("3ca3"),a("498a"),a("159b"),a("bd0c")),s=a("a0c5"),l=a("0605"),c=a("c0e9"),u=a.n(c),d=a("a01c"),m=a("a323"),p=(a("d8ad"),a("ed08"),{name:"BaseMapPosition",components:{BmlCurveLine:o.BmlCurveLine,flexibleContainer:s.default,roadTransport:l.default,Bmldriving:o.Bmldriving},props:{imgSize:{type:String,default:"small"}},computed:{addressList:function(){return this.$store.getters.getMapAddressList},singlePoint:function(){return this.$store.getters.getSinglePoint}},watch:{addressList:{handler:function(){var t=Object(i.a)(Object(n.a)().mark((function t(e){var a,i,o,s;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=16;break}return t.next=3,Object(m.a)(r,e);case 3:a=t.sent,i=a.controlPontList,o=a.pointsWithControl,s=a.points,this.pointsWithControl=o,this.controlPoint=i,this.points=s,this.start=this.pointsWithControl[0],this.end=this.pointsWithControl[2],this.zoom=Object(m.e)(o[0],o[1]),this.center={lng:this.controlPoint[0].point.lng+Object(m.d)(o[0],o[1]),lat:this.controlPoint[0].point.lat};case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},singlePoint:{handler:function(){var t=Object(i.a)(Object(n.a)().mark((function t(e){return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.b)(r,e);case 2:this.singlePoints=t.sent;case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}},data:function(){return{start:null,end:null,active:!1,zoom:6,center:"南京",address:{destlocation:"",originlocation:""},pointsWithControl:[],points:[],controlPoint:[],singlePoints:[]}},created:function(){},mounted:function(){},beforeDestroy:function(){this.$store.commit("INIT_ADDRESS_LIST")},methods:{svgToCanvas:function(t){return Array.from(t.getElementsByTagName("svg")).forEach(function(){var t=Object(i.a)(Object(n.a)().mark((function t(e){var a,r,i,o,s,l,c;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.parentNode,(r=document.createElement("canvas")).style.zIndex="0","svg"!==e.tagName){t.next=14;break}return i=e.querySelector("path").outerHTML.trim(),o=e.getBoundingClientRect(),s=o.width,l=o.height,r.width=s,r.height=l,c=r.getContext("2d"),t.next=11,d.a.from(c,i);case 11:t.sent.start(),e.style.position&&(r.style.position=999);case 14:a.appendChild(r),a.removeChild(e);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t},saveImage:function(){var t=this;return new Promise((function(e){var a=document.getElementById("bm-view");t.svgToCanvas(a),setTimeout((function(){u()(a,{useCORS:!0,onclone:function(){}}).then(function(){var a=Object(i.a)(Object(n.a)().mark((function a(r){var i,o,s;return Object(n.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=432,o=242,"big"===t.imgSize&&(i=864,o=484),a.next=5,t.resizedataURL(r.toDataURL("image/png"),i,o);case 5:s=a.sent,e({src:s});case 7:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}())}),0)}))},resizedataURL:function(t,e,a){return new Promise(function(){var r=Object(i.a)(Object(n.a)().mark((function r(i,o){var s;return Object(n.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:(s=document.createElement("img")).onload=function(){var t=document.createElement("canvas"),r=t.getContext("2d");t.width=e,t.height=a,r.drawImage(this,0,0,e,a);var n=t.toDataURL();i(n)},s.src=t;case 3:case"end":return r.stop()}}),r)})));return function(t,e){return r.apply(this,arguments)}}())},init:function(t){var e=t.BMap,a=t.map;r=e,this.map=a;var n=new e.Point(117.325,27.51);a.centerAndZoom(n,6),a.setCurrentCity("北京"),this.$emit("ready",{BMapGL:r,map:a})},getCityByLng:function(t){var e=t.lng,a=t.lat;return new Promise((function(t){(new r.Geocoder).getLocation(new r.Point(e,a),(function(e){t(e)}))}))}}}),g=p,h=(a("bb51"),a("2877")),f=Object(h.a)(g,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"map-wrap"},[r("baidu-map",{staticClass:"bm-view",attrs:{id:"bm-view",center:t.center,zoom:t.zoom,"scroll-wheel-zoom":!0},on:{ready:t.init}},[r("bm-driving",{attrs:{start:t.start,end:t.end,"auto-viewport":!1,policy:"BMAP_DRIVING_POLICY_LEAST_DISTANCE",panel:!1,location:"北京"}}),t._l(t.points,(function(t,e){return r("bm-marker",{key:e,attrs:{position:t,dragging:!0,icon:{url:a("5c9e3"),size:{width:32,height:32}}}})}))],2)],1)}),[],!1,null,"5264f0b1",null);e.default=f.exports},b20d:function(t,e,a){"use strict";a("78b9")},bb51:function(t,e,a){"use strict";a("06f8")},c3c4:function(t,e,a){"use strict";a("4b2a")},cac8:function(t,e,a){"use strict";a.r(e);var r=a("c7eb"),n=a("1da1"),i=a("15fd"),o=a("5530"),s=(a("7db0"),a("d81d"),a("a9e3"),a("d3b7"),a("ac1f"),a("5319"),a("9d44")),l=a("4e9f"),c=a("2ef0"),u=a.n(c),d=a("aed4"),m=["oriLatAndLng","destLatAndLng"],p={props:{cateNo:{type:String},id:{type:[String,Number]},type:{type:String,default:"add"}},data:function(){return{loading:!1,tForm:{storageName:null,cargoWeight:null,logisticsStage:null,containerCount:null,transportationDistance:null,logisticsStationType:2},logisticsStageList:[],rules:{storageName:[{required:!0,message:"请输入码头名称",trigger:["blur","change"]}],cargoWeight:[{required:!0,message:"请输入货物重量",trigger:["blur","change"]}],logisticsStage:[{required:!0,message:"请选择所属环节",trigger:["blur","change"]}],containerCount:[{required:!0,message:"请输入集装箱数量",trigger:["blur","change"]}],transportationDistance:[{required:!0,message:"请输入场内运输距离",trigger:["blur","change"]}]},oriLatAndLng:{},destLatAndLng:{}}},watch:{"tForm.storageName":{handler:function(t,e){var a=this;if(t){var r={address:t};Object(s.d)(r).then((function(t){200===t.code&&(a.oriLatAndLng={lng:t.data.lng,lat:t.data.lat},a.destLatAndLng={lng:t.data.lng,lat:t.data.lat},a.tForm.oriProvinceName=t.data.province||t.data.country,a.tForm.oriCityName=t.data.city,a.tForm.destProvinceName=t.data.province||t.data.country,a.tForm.destCityName=t.data.city,a.$store.commit("SET_SINGLE_LOCATION",[Object(o.a)(Object(o.a)({},a.oriLatAndLng),{},{transportType:"site"})]))}))}else this.$store.commit("SET_SINGLE_LOCATION",[])}}},mounted:function(){var t=this;if(this.id){this.$store.commit("SET_RESULT_INFO",this.id);var e=this.$store.getters.getResultItem,a=e.oriLatAndLng,r=e.destLatAndLng,n=Object(i.a)(e,m);this.$set(this,"tForm",n),this.oriLatAndLng=a||{},this.destLatAndLng=r||{};var o={lng:this.oriLatAndLng.lng,lat:this.oriLatAndLng.lat,transportType:"site"};this.$store.commit("SET_SINGLE_LOCATION",[o])}else{var s=this.$store.getters.getGoodsInfo||{};this.tForm.cargoWeight=u.a.round(Number(s.weight)/1e3,3)}Object(l.c)("tjsq_logistics_stage_type").then((function(e){t.logisticsStageList=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))}))},methods:{formatNumberDeci:d.formatNumberDeci,submit:function(){var t=this;return Object(n.a)(Object(r.a)().mark((function e(){var a,n,i,l;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$refs.tForm.validate();case 4:return a={storageName:t.tForm.storageName,cargoWeight:t.tForm.cargoWeight,logisticsStage:t.tForm.logisticsStage,containerCount:t.tForm.containerCount,transportationDistance:t.tForm.transportationDistance,logisticsStationType:t.tForm.logisticsStationType},e.next=8,Object(s.f)(a);case 8:if(200!==(n=e.sent).code){e.next=18;break}return i=Object(o.a)(Object(o.a)({},t.tForm),{},{id:n.data.id,distance:n.data.distance||t.tForm.transportationDistance||0,carbonEmissionQty:n.data.emission,cateNo:t.cateNo,oriLatAndLng:t.oriLatAndLng,destLatAndLng:t.destLatAndLng}),e.next=13,new Promise((function(e,a){t.$emit("saveMap2Image",e,a)}));case 13:(l=e.sent)&&(i.imgSrc=l),"add"===t.type?t.$store.commit("SET_RESULT_LIST",i):"edit"===t.type&&t.$store.commit("EDIT_RESULT_LIST",{data:i,originId:t.id}),t.$router.replace({name:"carbonResult"});case 18:t.loading=!1,e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),t.loading=!1;case 25:case"end":return e.stop()}}),e,null,[[0,21]])})))()},reset:function(){this.resetForm("tForm")},changeLogisticsStage:function(t){this.tForm.containerCount=null,this.tForm.transportationDistance=null;var e=this.logisticsStageList.find((function(e){return e.value===t}));e&&(this.tForm.logisticsStageLabel=e.label)}}},g=p,h=(a("f9da"),a("2877")),f=Object(h.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"station-transport"},[a("el-form",{ref:"tForm",attrs:{model:t.tForm,rules:t.rules,inline:!0}},["read"===t.type?a("div",{staticClass:"carbon-info"},[a("div",{staticClass:"carbon-title-box"},[a("div",{staticClass:"left"},[a("p",[t._v(" 里程："),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.distance,3)))]),a("span",{staticClass:"unit"},[t._v("km")])])]),a("div",{staticClass:"right"},[a("p",[t._v(" 温室气体排放:"),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.carbonEmissionQty,3)))]),a("span",{staticClass:"unit"},[t._v("kg")])])])]),a("el-divider")],1):t._e(),a("el-form-item",{attrs:{label:"场站名称",prop:"storageName"}},[a("el-input",{attrs:{placeholder:"请输入场站名称",disabled:"read"===t.type},model:{value:t.tForm.storageName,callback:function(e){t.$set(t.tForm,"storageName",e)},expression:"tForm.storageName"}})],1),a("el-form-item",{attrs:{label:"货物重量",prop:"cargoWeight"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入货物重量",disabled:""},model:{value:t.tForm.cargoWeight,callback:function(e){t.$set(t.tForm,"cargoWeight",e)},expression:"tForm.cargoWeight"}},[a("template",{slot:"append"},[t._v("t")])],2)],1),a("el-form-item",{attrs:{label:"所属环节",prop:"logisticsStage"}},[a("el-select",{attrs:{placeholder:"请选择所属环节",disabled:"read"===t.type},on:{change:t.changeLogisticsStage},model:{value:t.tForm.logisticsStage,callback:function(e){t.$set(t.tForm,"logisticsStage",e)},expression:"tForm.logisticsStage"}},t._l(t.logisticsStageList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),1==t.tForm.logisticsStage?a("el-form-item",{attrs:{label:"集装箱数量",prop:"containerCount"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入集装箱数量",disabled:"read"===t.type},model:{value:t.tForm.containerCount,callback:function(e){t.$set(t.tForm,"containerCount",e)},expression:"tForm.containerCount"}},[a("template",{slot:"append"},[t._v("TEU")])],2)],1):a("el-form-item",{attrs:{label:"场内运输距离",prop:"transportationDistance"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入场内运输距离",disabled:"read"===t.type},model:{value:t.tForm.transportationDistance,callback:function(e){t.$set(t.tForm,"transportationDistance",e)},expression:"tForm.transportationDistance"}},[a("template",{slot:"append"},[t._v("km")])],2)],1)],1),"read"!==t.type?a("div",{staticClass:"footer-btns"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交并测算")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"pain"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1):t._e()],1)}),[],!1,null,"51773698",null);e.default=f.exports},d116:function(t,e,a){"use strict";a("3194")},dbab:function(t,e,a){"use strict";a.r(e);var r=a("c7eb"),n=a("5530"),i=a("1da1"),o=a("15fd"),s=(a("99af"),a("4de4"),a("7db0"),a("d81d"),a("14d9"),a("a9e3"),a("d3b7"),a("ac1f"),a("5319"),a("9d44")),l=a("4e9f"),c=a("aed4"),u=a("ed08"),d=["oriLatAndLng","destLatAndLng"],m={props:{cateNo:{type:String},id:{type:[String,Number]},type:{type:String,default:"add"},quick:{type:Boolean,default:!1}},computed:{getMutiTransport:function(){return this.$store.getters.getMutiTransport},preTransportItem:function(){var t=this.$route.query,e=t.type,a=t.id,r=this.$store.getters.getResultList;return Object(c.getPreTransportItem)(r,a,e)}},data:function(){return{fuelListOptions:null,loading:!1,tForm:{mmsi:null,origin:null,dest:null,shipType:null,shipSize:null,transportWeight:null,factorProject:"122",transportType:8,quickCal:!1,fuelType:null,powerType:null,fuelTypeItem:null},shipTypeOptions:[{label:"原油油轮",value:1},{label:"成品油油轮",value:2},{label:"化工船",value:3},{label:"天然气船",value:4},{label:"液化气船",value:5}],rules:{shipType:[{required:!0,message:"请选择类型",trigger:"change"}],origin:[{required:!0,message:"请选择始发港口",trigger:["change","blur"]}],dest:[{required:!0,message:"请选择目的港口",trigger:["change","blur"]}]},showPort:!0,queryParams:{pageNum:1,pageSize:10,portName:null,cityName:null},portList1:[],portList2:[],oriLatAndLng:{},destLatAndLng:{},fuelTypeOptions:[]}},watch:{preTransportItem:{handler:function(t){t&&(this.queryParams.cityName=Object(u.e)(t))},immediate:!0},"tForm.origin":{handler:function(t,e){t&&this.handlePoints()}},"tForm.dest":{handler:function(t,e){t&&this.handlePoints()}}},mounted:function(){var t=this;if(this.getPowerAndFuel(),this.id){this.$store.commit("SET_RESULT_INFO",this.id);var e=this.$store.getters.getResultItem,a=e.oriLatAndLng,r=e.destLatAndLng,n=Object(o.a)(e,d);if(this.$set(this,"tForm",n),!0!==this.quick){this.oriLatAndLng=a,this.destLatAndLng=r;var i=[Object.assign({},this.tForm,{oriLatAndLng:a,destLatAndLng:r,cateNo:this.cateNo})];this.portList1.push(this.tForm.oriOptionItem),this.portList2.push(this.tForm.desOptionItem),this.$store.commit("SET_ADDRESS_LIST",Object(c.initPoints)(i))}}else if("add"===this.type){var s=this.$store.getters.getGoodsInfo||{};this.tForm.transportWeight=s.weight}Object(l.c)("tjsq_sea_fast_fuel_type").then((function(e){t.fuelTypeOptions=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))}))},methods:{valKgToTWithDecimals:u.j,unitKgToT:u.i,formatNumberDeci:c.formatNumberDeci,handlePoints:function(){var t=[{originLng:this.oriLatAndLng.lng,originLat:this.oriLatAndLng.lat,destLng:this.destLatAndLng.lng,destLat:this.destLatAndLng.lat,transportType:"boat"}];t=t.filter((function(t){return t.originLng&&t.originLat&&t.destLng&&t.destLat})),this.$store.commit("SET_ADDRESS_LIST",t)},submit:function(){var t=this;return Object(i.a)(Object(r.a)().mark((function e(){var a,i,o,l,c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$refs.tForm.validate();case 4:if(a={mmsi:t.tForm.mmsi,origin:t.tForm.origin,dest:t.tForm.dest,factorProject:t.tForm.factorProject,transportType:t.tForm.transportType,shipType:t.tForm.shipType,shipSize:t.tForm.shipSize,transportWeight:t.tForm.transportWeight},i=null,!t.tForm.quickCal){e.next=14;break}return o={transportType:9,powerType:t.tForm.powerType,fuelType:t.tForm.fuelType,actualEnergyConsumption:t.tForm.actualEnergyConsumption,factorProject:t.tForm.factorProject},e.next=11,Object(s.h)(o);case 11:i=e.sent,e.next=19;break;case 14:return e.next=16,Object(s.j)(a);case 16:return i=e.sent,e.next=19,t.savePositionCity(i);case 19:if(200!==i.code){e.next=28;break}return l=Object(n.a)(Object(n.a)({},t.tForm),{},{id:i.data.id,distance:i.data.distance,carbonEmissionQty:i.data.carbonEmissionQty,cateNo:t.cateNo,oriLatAndLng:t.oriLatAndLng,destLatAndLng:t.destLatAndLng}),e.next=23,new Promise((function(e,a){t.$emit("saveMap2Image",e,a)}));case 23:(c=e.sent)&&(l.imgSrc=c),"add"===t.type?t.$store.commit("SET_RESULT_LIST",l):"edit"===t.type&&t.$store.commit("EDIT_RESULT_LIST",{data:l,originId:t.id}),t.$router.replace({name:"carbonResult"});case 28:t.loading=!1,e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),t.loading=!1;case 34:case"end":return e.stop()}}),e,null,[[0,31]])})))()},reset:function(){Object.assign(this.tForm,{mmsi:null,origin:null,dest:null,shipType:null,shipSize:null,factorProject:"122",transportType:8})},resetQuery:function(t,e){this.queryParams.pageNum=1,this.queryParams.portName=t||"","origin"===e?this.portList1=[]:this.portList2=[]},remotePort:function(t,e){this.resetQuery(t,e),this.handleLazyload(e)},handleLazyload:function(t){var e=this;return Object(i.a)(Object(r.a)().mark((function a(){var n,i,o;return Object(r.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=Object.assign({},e.queryParams),"origin"!==t&&(n.cityName=null),i=null,!n.cityName){a.next=9;break}return a.next=6,Object(l.e)(n);case 6:i=a.sent,a.next=12;break;case 9:return a.next=11,Object(l.f)(n);case 11:i=a.sent;case 12:if(200===i.code){a.next=14;break}return a.abrupt("return");case 14:if(o=i.rows.map((function(t){return{label:t.portName,value:t.portCode,lng:t.longitude,lat:t.latitude,countryName:t.countryName,cityName:t.cityName}})),"origin"===t?e.portList1=e.portList1.concat(o):e.portList2=e.portList2.concat(o),0!==o.length){a.next=20;break}return a.abrupt("return");case 20:e.queryParams.pageNum++;case 21:case"end":return a.stop()}}),a)})))()},handleSelectVisible:function(t,e){t&&this.remotePort("",e)},changePort:function(t,e){if("origin"===e){var a=this.portList1.find((function(e){return e.value===t}));a&&(this.oriLatAndLng.lng=a.lng,this.oriLatAndLng.lat=a.lat,this.tForm.originCountry=a.countryName,this.tForm.oriCityName=a.label,this.tForm.oriOptionItem=a,this.tForm.oriLabel=a.label,this.tForm.oriSubLabel=a.countryName)}else{var r=this.portList2.find((function(e){return e.value===t}));r&&(this.destLatAndLng.lng=r.lng,this.destLatAndLng.lat=r.lat,this.tForm.destCountry=r.countryName,this.tForm.destCityName=r.label,this.tForm.desOptionItem=r,this.tForm.destLabel=r.label,this.tForm.destSubLabel=r.countryName)}},getPowerAndFuel:function(){var t=this;return Object(i.a)(Object(r.a)().mark((function e(){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.g)();case 2:a=e.sent,t.fuelListOptions=a.data.map((function(t){return Object(n.a)({children:t.subFuelVOList},t)}));case 4:case"end":return e.stop()}}),e)})))()},handleChange:function(){var t=this;this.tForm.powerType=this.tForm.fuelTypeItem[0],this.tForm.fuelType=this.tForm.fuelTypeItem[1];var e=this.fuelListOptions.find((function(e){return e.value==t.tForm.powerType})),a=e.label,r=e.children.find((function(e){return e.value==t.tForm.fuelType})).label;this.tForm.powerOrFuelName=a+"/"+r},checkBoxChange:function(){this.tForm.quickCal&&(this.tForm.origin=null,this.tForm.dest=null,this.$store.commit("INIT_FINAL_IMG"))},savePositionCity:function(){var t=this;return Object(i.a)(Object(r.a)().mark((function e(){var a,n,i,o,s,l;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.oriLatAndLng.lat){e.next=11;break}return a=t.oriLatAndLng.lng,n=t.oriLatAndLng.lat,e.next=5,t.searchCityByLng({lng:a,lat:n});case 5:i=e.sent,t.tForm.oriCityName=i.addressComponents.city,t.tForm.oriProvinceName=i.addressComponents.province,e.next=12;break;case 11:case 12:if(!t.destLatAndLng.lat){e.next=23;break}return o=t.destLatAndLng.lng,s=t.destLatAndLng.lat,e.next=17,t.searchCityByLng({lng:o,lat:s});case 17:l=e.sent,t.tForm.destCityName=l.addressComponents.city,t.tForm.destProvinceName=l.addressComponents.province,e.next=24;break;case 23:case 24:case"end":return e.stop()}}),e)})))()},searchCityByLng:function(t){var e=this;return Object(i.a)(Object(r.a)().mark((function a(){var n,i;return Object(r.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.lng,i=t.lat,a.next=4,e.$parent.$parent.$refs.baiduMap.getCityByLng({lng:n,lat:i});case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}}),a)})))()},changeFuelType:function(t){var e=this.fuelTypeOptions.find((function(e){return e.value===t}));this.tForm.powerOrFuelName=e.label}}},p=m,g=(a("d116"),a("2877")),h=Object(g.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"road-transport"},[a("el-form",{ref:"tForm",attrs:{model:t.tForm,rules:t.rules,inline:!0,"show-message":!1}},["read"===t.type?a("div",{staticClass:"carbon-info"},[a("div",{staticClass:"carbon-title-box"},[a("div",{staticClass:"left"},[a("p",[t._v(" 里程："),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.distance,3)))]),a("span",{staticClass:"unit"},[t._v("km")])])]),a("div",{staticClass:"right"},[a("p",[t._v(" 温室气体排放:"),a("em",[t._v(t._s(t.valKgToTWithDecimals(t.tForm.carbonEmissionQty,5)))]),a("span",{staticClass:"unit"},[t._v(t._s(t.unitKgToT(t.tForm.carbonEmissionQty,5)))])])])]),a("el-divider")],1):t._e(),t._e(),[a("el-form-item",{attrs:{label:"始发港口",prop:t.tForm.quickCal?"":"origin"}},[a("el-select",{directives:[{name:"elSelectLazyloading",rawName:"v-elSelectLazyloading",value:{handleLazyload:function(){return t.handleLazyload("origin")}},expression:"{ handleLazyload: () => handleLazyload('origin') }"}],attrs:{placeholder:"请选择始发港口",disabled:"read"===t.type||t.tForm.quickCal,filterable:"",remote:"","remote-method":function(e){return t.remotePort(e,"origin")}},on:{change:function(e){return t.changePort(e,"origin")},"visible-change":function(e){return t.handleSelectVisible(e,"origin")}},model:{value:t.tForm.origin,callback:function(e){t.$set(t.tForm,"origin",e)},expression:"tForm.origin"}},t._l(t.portList1,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"目的港口",prop:t.tForm.quickCal?"":"dest"}},[a("el-select",{directives:[{name:"elSelectLazyloading",rawName:"v-elSelectLazyloading",value:{handleLazyload:function(){return t.handleLazyload("dest")}},expression:"{ handleLazyload: () => handleLazyload('dest') }"}],attrs:{placeholder:"请选择目的港口",disabled:"read"===t.type||t.tForm.quickCal,filterable:"",remote:"","remote-method":function(e){return t.remotePort(e,"dest")}},on:{change:function(e){return t.changePort(e,"dest")},"visible-change":function(e){return t.handleSelectVisible(e,"dest")}},model:{value:t.tForm.dest,callback:function(e){t.$set(t.tForm,"dest",e)},expression:"tForm.dest"}},t._l(t.portList2,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],a("el-divider"),t.getMutiTransport?t._e():a("el-checkbox",{staticClass:"speed",attrs:{disabled:"read"===t.type},on:{change:t.checkBoxChange},model:{value:t.tForm.quickCal,callback:function(e){t.$set(t.tForm,"quickCal",e)},expression:"tForm.quickCal"}},[t._v("采取能耗速算")]),t.tForm.quickCal?a("el-form-item",{attrs:{label:"动力/燃料类型",prop:"fuelTypeItem"}},[a("el-select",{attrs:{placeholder:"请选择燃料类型",disabled:"read"===t.type},on:{change:t.changeFuelType},model:{value:t.tForm.fuelType,callback:function(e){t.$set(t.tForm,"fuelType",e)},expression:"tForm.fuelType"}},t._l(t.fuelTypeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1):t._e(),t.tForm.quickCal?a("el-form-item",{attrs:{label:"实际能耗",prop:"actualEnergyConsumption"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入实际能耗",disabled:"read"===t.type},model:{value:t.tForm.actualEnergyConsumption,callback:function(e){t.$set(t.tForm,"actualEnergyConsumption",e)},expression:"tForm.actualEnergyConsumption"}},[a("template",{slot:"append"},[t._v("L")])],2)],1):t._e(),t.tForm.quickCal?t._e():a("el-form-item",{attrs:{label:"类型",required:"",prop:"shipType"}},[a("el-select",{attrs:{placeholder:"请选择类型",disabled:"read"===t.type},model:{value:t.tForm.shipType,callback:function(e){t.$set(t.tForm,"shipType",e)},expression:"tForm.shipType"}},t._l(t.shipTypeOptions,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1)],1),t.tForm.quickCal?t._e():a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"载荷",required:"",prop:"shipSize"}},[a("template",{slot:"label"},[t._v(" 载荷 "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"对于原油油轮、成品油油轮、化工船，单位应为dwt,对于液化石油气船、液化天然气船，单位应为m³",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),a("el-input",{attrs:{type:"number",step:"0.01",placeholder:"请输入载荷",disabled:"read"===t.type},model:{value:t.tForm.shipSize,callback:function(e){t.$set(t.tForm,"shipSize",e)},expression:"tForm.shipSize"}},[a("template",{slot:"append"},[t._v("dwt/m³")])],2)],2)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"货物重量",required:"",prop:"transportWeight"}},[a("template",{slot:"label"},[t._v(" 货物重量 ")]),a("el-input",{attrs:{placeholder:"请输入货物重量",disabled:!0},model:{value:t.tForm.transportWeight,callback:function(e){t.$set(t.tForm,"transportWeight",e)},expression:"tForm.transportWeight"}},[a("template",{slot:"append"},[t._v("kg")])],2)],2)],1)],1)],2),"read"!==t.type?a("div",{staticClass:"footer-btns"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交并测算 ")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"pain"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1):t._e()],1)}),[],!1,null,"9656da2a",null);e.default=h.exports},f9b2:function(t,e,a){"use strict";a.r(e);var r=a("c7eb"),n=a("1da1"),i=a("15fd"),o=a("5530"),s=(a("7db0"),a("d81d"),a("a9e3"),a("d3b7"),a("ac1f"),a("5319"),a("9d44")),l=a("4e9f"),c=a("2ef0"),u=a.n(c),d=a("aed4"),m=["oriLatAndLng","destLatAndLng"],p={props:{cateNo:{type:String},id:{type:[String,Number]},type:{type:String,default:"add"}},data:function(){return{loading:!1,tForm:{storageName:null,cargoWeight:null,logisticsStage:null,containerCount:null,transportationDistance:null,logisticsStationType:3},logisticsStageList:[],rules:{storageName:[{required:!0,message:"请输入码头名称",trigger:["blur","change"]}],cargoWeight:[{required:!0,message:"请输入货物重量",trigger:["blur","change"]}],logisticsStage:[{required:!0,message:"请选择所属环节",trigger:["blur","change"]}],containerCount:[{required:!0,message:"请输入集装箱数量",trigger:["blur","change"]}],transportationDistance:[{required:!0,message:"请输入场内运输距离",trigger:["blur","change"]}]},oriLatAndLng:{},destLatAndLng:{}}},watch:{"tForm.storageName":{handler:function(t,e){var a=this;if(t){var r={address:t};Object(s.d)(r).then((function(t){200===t.code&&(a.oriLatAndLng={lng:t.data.lng,lat:t.data.lat},a.destLatAndLng={lng:t.data.lng,lat:t.data.lat},a.tForm.oriProvinceName=t.data.province||t.data.country,a.tForm.oriCityName=t.data.city,a.tForm.destProvinceName=t.data.province||t.data.country,a.tForm.destCityName=t.data.city,a.$store.commit("SET_SINGLE_LOCATION",[Object(o.a)(Object(o.a)({},a.oriLatAndLng),{},{transportType:"wharf"})]))}))}else this.$store.commit("SET_SINGLE_LOCATION",[])}}},mounted:function(){var t=this;if(this.id){this.$store.commit("SET_RESULT_INFO",this.id);var e=this.$store.getters.getResultItem,a=e.oriLatAndLng,r=e.destLatAndLng,n=Object(i.a)(e,m);this.$set(this,"tForm",n),this.oriLatAndLng=a||{},this.destLatAndLng=r||{};var o={lng:this.oriLatAndLng.lng,lat:this.oriLatAndLng.lat,transportType:"wharf"};this.$store.commit("SET_SINGLE_LOCATION",[o])}else{var s=this.$store.getters.getGoodsInfo||{};this.tForm.cargoWeight=u.a.round(Number(s.weight)/1e3,3)}Object(l.c)("tjsq_logistics_stage_type").then((function(e){t.logisticsStageList=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))}))},methods:{formatNumberDeci:d.formatNumberDeci,submit:function(){var t=this;return Object(n.a)(Object(r.a)().mark((function e(){var a,n,i,l;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$refs.tForm.validate();case 4:return a={storageName:t.tForm.storageName,cargoWeight:t.tForm.cargoWeight,logisticsStage:t.tForm.logisticsStage,transportationDistance:t.tForm.transportationDistance,logisticsStationType:t.tForm.logisticsStationType},e.next=8,Object(s.f)(a);case 8:if(200!==(n=e.sent).code){e.next=18;break}return i=Object(o.a)(Object(o.a)({},t.tForm),{},{id:n.data.id,distance:n.data.distance||t.tForm.transportationDistance,carbonEmissionQty:n.data.emission,cateNo:t.cateNo,oriLatAndLng:t.oriLatAndLng,destLatAndLng:t.destLatAndLng}),e.next=13,new Promise((function(e,a){t.$emit("saveMap2Image",e,a)}));case 13:(l=e.sent)&&(i.imgSrc=l),"add"===t.type?t.$store.commit("SET_RESULT_LIST",i):"edit"===t.type&&t.$store.commit("EDIT_RESULT_LIST",{data:i,originId:t.id}),t.$router.replace({name:"carbonResult"});case 18:t.loading=!1,e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),t.loading=!1;case 25:case"end":return e.stop()}}),e,null,[[0,21]])})))()},reset:function(){this.resetForm("tForm")},changeLogisticsStage:function(t){this.tForm.containerCount=null,this.tForm.transportationDistance=null;var e=this.logisticsStageList.find((function(e){return e.value===t}));e&&(this.tForm.logisticsStageLabel=e.label)}}},g=p,h=(a("c3c4"),a("2877")),f=Object(h.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wharf-transport"},[a("el-form",{ref:"tForm",attrs:{model:t.tForm,rules:t.rules,inline:!0}},["read"===t.type?a("div",{staticClass:"carbon-info"},[a("div",{staticClass:"carbon-title-box"},[a("div",{staticClass:"left"},[a("p",[t._v(" 里程："),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.distance,3)))]),a("span",{staticClass:"unit"},[t._v("km")])])]),a("div",{staticClass:"right"},[a("p",[t._v(" 温室气体排放:"),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.carbonEmissionQty,3)))]),a("span",{staticClass:"unit"},[t._v("kg")])])])]),a("el-divider")],1):t._e(),a("el-form-item",{attrs:{label:"码头名称",prop:"storageName"}},[a("el-input",{attrs:{placeholder:"请输入码头名称",disabled:"read"===t.type},model:{value:t.tForm.storageName,callback:function(e){t.$set(t.tForm,"storageName",e)},expression:"tForm.storageName"}})],1),a("el-form-item",{attrs:{label:"货物重量",prop:"cargoWeight"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入货物重量",disabled:!0},model:{value:t.tForm.cargoWeight,callback:function(e){t.$set(t.tForm,"cargoWeight",e)},expression:"tForm.cargoWeight"}},[a("template",{slot:"append"},[t._v("t")])],2)],1),a("el-form-item",{attrs:{label:"所属环节",prop:"logisticsStage"}},[a("el-select",{attrs:{placeholder:"请选择所属环节"},on:{change:t.changeLogisticsStage},model:{value:t.tForm.logisticsStage,callback:function(e){t.$set(t.tForm,"logisticsStage",e)},expression:"tForm.logisticsStage"}},t._l(t.logisticsStageList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),1==t.tForm.logisticsStage?a("el-form-item",{attrs:{label:"集装箱数量",prop:"containerCount"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入集装箱数量",disabled:"read"===t.type},model:{value:t.tForm.containerCount,callback:function(e){t.$set(t.tForm,"containerCount",e)},expression:"tForm.containerCount"}},[a("template",{slot:"append"},[t._v("TEU")])],2)],1):a("el-form-item",{attrs:{label:"场内运输距离",prop:"transportationDistance"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入场内运输距离",disabled:"read"===t.type},model:{value:t.tForm.transportationDistance,callback:function(e){t.$set(t.tForm,"transportationDistance",e)},expression:"tForm.transportationDistance"}},[a("template",{slot:"append"},[t._v("km")])],2)],1)],1),"read"!==t.type?a("div",{staticClass:"footer-btns"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交并测算")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"pain"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1):t._e()],1)}),[],!1,null,"476b531a",null);e.default=f.exports},f9da:function(t,e,a){"use strict";a("2545")}}]);