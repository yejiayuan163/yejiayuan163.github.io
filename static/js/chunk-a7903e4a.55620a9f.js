(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a7903e4a","chunk-2d21406a"],{"0f79":function(t,e,a){"use strict";a.r(e);var r=a("c7eb"),n=a("1da1"),o=a("5530"),i=(a("7db0"),a("d81d"),a("a9e3"),a("d3b7"),a("ac1f"),a("5319"),a("9d44")),c=a("4e9f"),s=a("aed4"),u={props:{cateNo:{type:String},id:{type:[String,Number]},type:{type:String,default:"add"}},data:function(){return{loading:!1,tForm:{storageName:null,storageType:null,cargoVolume:null,logisticsStage:null,logisticsStationType:1},storageTypeList:[{value:"1",label:"常温库"},{value:"2",label:"冷库"}],rules:{storageName:[{required:!0,message:"请输入仓库详细地址",trigger:["change","blur"]}],storageType:[{required:!0,message:"请选择仓库类型",trigger:"change"}],cargoVolume:[{required:!0,message:"请输入货物体积",trigger:["change","blur"]}]},oriLatAndLng:{},destLatAndLng:{}}},watch:{"tForm.storageName":{handler:function(t,e){var a=this;if(t){var r={address:t};Object(i.d)(r).then((function(t){200===t.code&&(a.oriLatAndLng={lng:t.data.lng,lat:t.data.lat},a.destLatAndLng={lng:t.data.lng,lat:t.data.lat},a.tForm.oriProvinceName=t.data.province||t.data.country,a.tForm.oriCityName=t.data.city,a.tForm.destProvinceName=t.data.province||t.data.country,a.tForm.destCityName=t.data.city,a.$store.commit("SET_SINGLE_LOCATION",[Object(o.a)(Object(o.a)({},a.oriLatAndLng),{},{transportType:"shop"})]))}))}else this.$store.commit("SET_SINGLE_LOCATION",[])}}},mounted:function(){var t=this;if(this.id){this.$store.commit("SET_RESULT_INFO",this.id);var e=this.$store.getters.getResultItem;this.$set(this,"tForm",e),this.oriLatAndLng=oriLatAndLng||{},this.destLatAndLng=destLatAndLng||{};var a={lng:this.oriLatAndLng.lng,lat:this.oriLatAndLng.lat,transportType:"shop"};this.$store.commit("SET_SINGLE_LOCATION",[a])}else{var r=this.$store.getters.getGoodsInfo||{};this.tForm.cargoVolume=r.volume}Object(c.c)("tjsq_storage_type").then((function(e){t.storageTypeList=e.data.map((function(t){return{label:t.dictLabel,value:t.dictValue}}))}))},methods:{formatNumberDeci:s.formatNumberDeci,submit:function(){var t=this;return Object(n.a)(Object(r.a)().mark((function e(){var a,n,c,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$refs.tForm.validate();case 4:return a={storageName:t.tForm.storageName,storageType:t.tForm.storageType,cargoVolume:t.tForm.cargoVolume,logisticsStage:t.tForm.logisticsStage,logisticsStationType:t.tForm.logisticsStationType},e.next=8,Object(i.f)(a);case 8:if(200!==(n=e.sent).code){e.next=18;break}return c=Object(o.a)(Object(o.a)({},t.tForm),{},{id:n.data.id,distance:n.data.distance||0,carbonEmissionQty:n.data.emission,cateNo:t.cateNo,oriLatAndLng:t.oriLatAndLng,destLatAndLng:t.destLatAndLng}),e.next=13,new Promise((function(e,a){t.$emit("saveMap2Image",e,a)}));case 13:(s=e.sent)&&(c.imgSrc=s),"add"===t.type?t.$store.commit("SET_RESULT_LIST",c):"edit"===t.type&&t.$store.commit("EDIT_RESULT_LIST",{data:c,originId:t.id}),t.$router.replace({name:"carbonResult"});case 18:t.loading=!1,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),t.loading=!1;case 24:case"end":return e.stop()}}),e,null,[[0,21]])})))()},reset:function(){this.resetForm("tForm")},changeStorageType:function(t){var e=this.storageTypeList.find((function(e){return e.value===t}));e&&(this.tForm.storageTypeLabel=e.label)}}},l=u,d=(a("8cc4"),a("2877")),m=Object(d.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"road-transport"},[a("el-form",{ref:"tForm",attrs:{model:t.tForm,rules:t.rules,inline:!0}},["read"===t.type?a("div",{staticClass:"carbon-info"},[a("div",{staticClass:"carbon-title-box"},[a("div",{staticClass:"left"},[a("p",[t._v(" 里程："),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.distance,3)))]),a("span",{staticClass:"unit"},[t._v("km")])])]),a("div",{staticClass:"right"},[a("p",[t._v(" 温室气体排放:"),a("em",[t._v(t._s(t.formatNumberDeci(t.tForm.carbonEmissionQty,3)))]),a("span",{staticClass:"unit"},[t._v("kg")])])])]),a("el-divider")],1):t._e(),a("el-form-item",{attrs:{label:"仓库位置",prop:"storageName"}},[a("el-input",{attrs:{placeholder:"请输入仓库详细地址",disabled:"read"===t.type},model:{value:t.tForm.storageName,callback:function(e){t.$set(t.tForm,"storageName",e)},expression:"tForm.storageName"}})],1),a("el-form-item",{attrs:{label:"仓库类型",prop:"storageType"}},[a("el-select",{attrs:{placeholder:"请选择仓库类型",disabled:"read"===t.type},on:{change:t.changeStorageType},model:{value:t.tForm.storageType,callback:function(e){t.$set(t.tForm,"storageType",e)},expression:"tForm.storageType"}},t._l(t.storageTypeList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"货物体积",prop:"cargoVolume"}},[a("el-input",{attrs:{type:"input",placeholder:"请输入货物体积",disabled:""},model:{value:t.tForm.cargoVolume,callback:function(e){t.$set(t.tForm,"cargoVolume",e)},expression:"tForm.cargoVolume"}},[a("template",{slot:"append"},[t._v("m³")])],2)],1)],1),"read"!==t.type?a("div",{staticClass:"footer-btns"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交并测算")])],1),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"pain"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1):t._e()],1)}),[],!1,null,"36b42824",null);e.default=m.exports},"4e9f":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return o})),a.d(e,"i",(function(){return i})),a.d(e,"g",(function(){return c})),a.d(e,"d",(function(){return s})),a.d(e,"c",(function(){return u})),a.d(e,"f",(function(){return l})),a.d(e,"e",(function(){return d})),a.d(e,"h",(function(){return m}));var r=a("b775");function n(t){return Object(r.a)({url:"/carbon/airport/getAirportByCityName/"+t,method:"get"})}function o(t){return Object(r.a)({url:"/carbon/airport/getAirportPageByNameLike",method:"post",data:t})}function i(){return Object(r.a)({url:"/carbon/calc/getVehicleTypeList",method:"get"})}function c(){return Object(r.a)({url:"/carbon/power/fuel/getPowerAndFuelList",method:"get"})}function s(){return Object(r.a)({url:"/carbon/calc/getFactorProjectList",method:"get"})}function u(t){return Object(r.a)({url:"/dict/data/type/"+t,method:"get"})}function l(t){return Object(r.a)({url:"/carbon/port/getPortPageByPortName",method:"post",data:t})}function d(t){return Object(r.a)({url:"/carbon/port/getPortPageByCityName",method:"post",data:t})}function m(t){return Object(r.a)({url:"/carbon/railwayStation/getRailwayStationPageByName",method:"post",data:t})}},"66a1":function(t,e,a){},"8cc4":function(t,e,a){"use strict";a("66a1")},"9d44":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return o})),a.d(e,"j",(function(){return i})),a.d(e,"h",(function(){return c})),a.d(e,"i",(function(){return s})),a.d(e,"f",(function(){return u})),a.d(e,"e",(function(){return l})),a.d(e,"c",(function(){return d})),a.d(e,"d",(function(){return m})),a.d(e,"g",(function(){return g}));var r=a("b775");function n(t){return Object(r.a)({url:"/carbon/calc/airTransportCEmission",method:"post",data:t})}function o(t){return Object(r.a)({url:"/carbon/calc/automobileTransportCEmission",method:"post",data:t})}function i(t){return Object(r.a)({url:"/carbon/calc/transportCEmissionSeaCalc",method:"post",data:t})}function c(t){return Object(r.a)({url:"/carbon/calc/transportCEmissionFastCalc",method:"post",data:t})}function s(t){return Object(r.a)({url:"/carbon/calc/transportCEmissionRailwayCalc",method:"post",data:t})}function u(t){return Object(r.a)({url:"/carbon/calc/logisticsStationCEmissionCalc",method:"post",data:t})}function l(){return Object(r.a)({url:"/carbon/province/city/getProvinceListByLike/",method:"get"})}function d(t){return Object(r.a)({url:"/carbon/province/city/getCityListByLikeAndPCode",method:"post",data:t})}function m(t){return Object(r.a)({url:"/carbon/addressLocate/getLocationMessageByAddress",method:"post",data:t})}function g(t){return Object(r.a)({url:"/carbon/calcOrg/organizationalCarbonCalculate",method:"post",data:t})}},aed4:function(t,e,a){"use strict";a.r(e),a.d(e,"cateNoList",(function(){return o})),a.d(e,"getTransportIcon",(function(){return i})),a.d(e,"initPoints",(function(){return c})),a.d(e,"formatNumberDeci",(function(){return s})),a.d(e,"getPreTransportItem",(function(){return u})),a("c740"),a("14d9"),a("a9e3"),a("d3b7"),a("159b");var r=a("2ef0"),n=a.n(r),o=[{icon:"goodsTrain",name:"道路运输",cateNo:"glys"},{icon:"railway",name:"铁路运输",cateNo:"tlys"},{icon:"ship",name:"水路运输",cateNo:"syys"},{icon:"airplane",name:"航空运输",cateNo:"kyys"},{icon:"shopStore",name:"仓库",cateNo:"cksy"},{icon:"site",name:"集装箱场站",cateNo:"czsy"},{icon:"wharf",name:"码头",cateNo:"mtsy"},{icon:"help",name:"配送",cateNo:"ps",open:!1},{icon:"port",name:"港口",cateNo:"gk",open:!1},{icon:"inlandPort",name:"内陆港",cateNo:"nlg",open:!1},{icon:"airPort",name:"航空港",cateNo:"hkg",open:!1},{icon:"package",name:"包装",cateNo:"bz",open:!1}];function i(t){var e="";switch(t){case"syys":e="boat";break;case"kyys":e="plant";break;case"tlys":e="train";break;case"glys":e="car";break;case"mtsy":e="wharf";break;case"czsy":e="site";break;case"cksy":e="shop"}return e}var c=function(t){var e=[];return(t||[]).forEach((function(t){var a={};"glys"===t.cateNo?(a.originLocation=t.oriProvinceName+t.oriCityName,a.destLocation=t.destProvinceName+t.destCityName):t.oriLatAndLng&&t.destLatAndLng&&(a.originLng=t.oriLatAndLng.lng,a.originLat=t.oriLatAndLng.lat,a.destLng=t.destLatAndLng.lng,a.destLat=t.destLatAndLng.lat),a.transportType=i(t.cateNo),e.push(a)})),e},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return n.a.round(Number(t),e)},u=function(t,e,a){var r=null;if("edit"===a&&e){var n=t.findIndex((function(t){return t.id===e}));n>0&&(r=t[n-1])}else r=t[t.length-1];return r}}}]);